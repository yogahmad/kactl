\chapter{Number theory}

\section{Modular arithmetic}
\kactlimport{ModularArithmetic.h}
\kactlimport{ModInverse.h}
\kactlimport{ModPow.h}
\kactlimport{ModSum.h}
\kactlimport{ModMulLL.h}
\kactlimport{ModSqrt.h}

\section{Primality}
% \kactlimport{eratosthenes.h}
\kactlimport{MillerRabinAndPollardRho.h}

\section{Divisibility}
\kactlimport{euclid.h}

\subsection{BÃ©zout's identity}
For $a \neq $, $b \neq 0$, then $d=gcd(a,b)$ is the smallest positive integer for which there are integer solutions to
$$ax+by=d$$
If $(x,y)$ is one solution, then all solutions are given by
$$\left(x+\frac{kb}{\gcd(a,b)}, y-\frac{ka}{\gcd(a,b)}\right), \quad k\in\mathbb{Z}$$

\kactlimport{phiFunction.h}

\section{Fractions}
\kactlimport{ContinuedFractions.h}
\kactlimport{FracBinarySearch.h}

\section{Chinese remainder theorem}
\kactlimport{chinese.h}

\section{Pythagorean Triples}
The Pythagorean triples are uniquely generated by
\[ a=k\cdot (m^{2}-n^{2}),\ \,b=k\cdot (2mn),\ \,c=k\cdot (m^{2}+n^{2}), \]
with $m > n > 0$, $k > 0$, $m \bot n$, and either $m$ or $n$ even.

\section{Primes}
$p=962592769$ is such that $2^{21} \mid p-1$, which may be useful. For hashing
use 970592641 (31-bit number), 31443539979727 (45-bit), 3006703054056749
(52-bit). There are 78498 primes less than 1\,000\,000. 664\,579 primes under $10^{7}$, 
5\,761\,455 primes under $10^{7}$, 50.847.534 primes under $10^{9}$.

Primitive roots exist modulo any prime power $p^a$, except for $p = 2, a > 2$, and there are $\phi(\phi(p^a))$ many.
For $p = 2, a > 2$, the group $\mathbb Z_{2^a}^\times$ is instead isomorphic to $\mathbb Z_2 \times \mathbb Z_{2^{a-2}}$.

\section{Estimates}
$\sum_{d|n} d = O(n \log \log n)$.

The number of divisors of $n$ is at most around 100 for $n < 5e4$, 500 for $n < 1e7$, 2000 for $n < 1e10$, 200\,000 for $n < 1e19$.

\section{Mobius Inversion}
\subsection{Definition}
\[\mu(n) =
	\left\{\begin{matrix}
	0 & n\,isn't\,square\,free\,\\ 
	1 & if\,n\,is\,equal\,to\,1  \\ 
	(-1)^{k} & n\,has\,k\,distinct\,prime    
	\end{matrix}\right.\]
	If f ang d are arithmetic function satisfying
	\[g(n)=\sum_{d|n}^{\,}f(d)\]
	Then
	\[f(n)=\sum_{d|n}^{\,}\mu(d)g(\frac{n}{d})\]
	\subsection{Example}
	Find:
	\[\sum_{i=1}^{n} \sum_{j=i+1}^{n} gcd(i,j)\]
	Can be transformed into:
	\[G = \sum_{g=1}^{n} h(g) * cnt(g)\]
	In this example, $h(g) = g$. Present $h(g)$ as mobius with:
	\[rep(i,1,n) rep(j,i,n,i) f[j]=h[i]*\mu(\frac{j}{i})\]
	Then:
	\[G = \sum_{g=1}^{n}(\sum_{d|g}f(d)) * cnt(g)\]
	\[G = \sum_{d=1}^{n} f(d) * cnt2(d)\] 
	here $cnt2(d) =$ how many $d$ such that $gcd(i,j)$ is multiple of d. This is easy to count:
	\[G = \sum_{d=1}^{n} f(d)\binom{\frac{n}{d}}{2}\] 
	$f(d)$ is happened to be totient here. Note that we can calculate f using 2 for loops above.
			
	\subsection{Example 2}
	Find $triplet(i,j,k)$ such that $gcd(a[i], a[j], a[k])=1$. \\
	Same as step above, but $h(g) = 1$ only if $g=1$ else $h(g)=0$. \\
	After some calculation, $cnt2(d) = gcd(a[i], a[j], a[k])$ is multiple of d. \\
	If $dp[x]$ is the number of i such that $x | a[i]$, then $cnt2[d] = C(dp[x], 3)$
	
	\subsection{Example 3}
	Find out sum of $lcm(x,y)$ for each pair $(x,y)$ in range $(1,n)$
	Answer: 
	\[g(l) = \sum_{d|l} \mu(d)ld\]
	\[f(n)=\sum_{l=1}^{n}\binom{\frac{n}{l}+1}{2}^2g(l)\]
				
	\subsection{Helper $O(2\sqrt{n})$}
	Loop through different values of n/d. \\
	for(int $i = 1; la; i <= n; i = la+1$)  
	la = n / (n / i); \\
	n/x yields the same value for $i <= x <= la$
