<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head><script src="https://pubsub.codeforces.com/lp/5b997e207ee8e129162df8c6343154b0ebc39cff/587b023efed37e6d027764a4aa283b8cfbce4bcc?&amp;tag=&amp;time=&amp;eventid=&amp;callback=PushStreamManager_0_onmessage_1556285920778&amp;_=1556285920778" async="async" id="PushStreamManager_0"></script>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="f166c9ad168de66629c48afdd4741d0f">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <script src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/sdk_002.js" async="" crossorigin="anonymous"></script><script type="text/javascript" async="" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/ga.js"></script><script id="facebook-jssdk" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/sdk.js"></script><script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery-1.js"></script>
    <script type="application/javascript">
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }
    </script>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="e1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//st.codeforces.com/s/12135/images/codeforces-telegram-square.png">
    <link rel="image_src" href="https://st.codeforces.com/s/12135/images/codeforces-telegram-square.png">
    <meta property="og:title" content="[Tutorial] Sack (dsu on tree) - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    <meta name="uc" content="5b997e207ee8e129162df8c6343154b0ebc39cff">
    <meta name="usmc" content="587b023efed37e6d027764a4aa283b8cfbce4bcc">
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>[Tutorial] Sack (dsu on tree) - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/font-awesome.css" type="text/css" charset="utf-8">

        <link href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/css.css" rel="stylesheet" type="text/css">
        <link href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/css_002.css" rel="stylesheet" type="text/css">


    <link rel="shortcut icon" type="image/png" href="https://st.codeforces.com/s/12135/favicon.png">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_003.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_002.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_004.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/codeforces.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    </script>
    <script type="text/javascript" async="" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/MathJax.js">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/prettify.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/moment-with-locales.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/pushstream.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_008.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_002.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_012.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/facebox.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_003.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/wysiwyg.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/wysiwyg_002.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/wysiwyg_003.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/wysiwyg_004.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_006.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_010.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_005.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_004.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_007.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_011.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/clipboard.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/autosize.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/sjcl.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/codeforces-options.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/codeforces.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/EventCatcher.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/preparedVerdictFormats-en.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/style_003.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/style_002.css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/share.js" charset="utf-8"></script>

    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/jquery_009.js"></script>
    <script type="text/javascript" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->


<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css" id="ya_share_style">.b-share-popup-wrap{z-index:1073741823;position:absolute;width:500px}.b-share-popup{position:absolute;z-index:1073741823;border:1px solid #888;background:#FFF;color:#000}.b-share-popup-wrap .b-share-popup_down{top:0}.b-share-popup-wrap .b-share-popup_up{bottom:0}.b-share-popup-wrap_state_hidden{position:absolute!important;top:-9999px!important;right:auto!important;bottom:auto!important;left:-9999px!important;visibility:hidden!important}.b-share-popup,x:nth-child(1){border:0;padding:1px!important}@media all and (resolution=0){.b-share-popup,x:nth-child(1),x:-o-prefocus{padding:0!important;border:1px solid #888}}.b-share-popup__i{display:-moz-inline-box;display:inline-block;padding:5px 0!important;overflow:hidden;vertical-align:top;white-space:nowrap;visibility:visible;background:#FFF;-webkit-box-shadow:0 2px 9px rgba(0,0,0,.6);-moz-box-shadow:0 2px 9px rgba(0,0,0,.6);box-shadow:0 2px 9px rgba(0,0,0,.6)}.b-share-popup__item{font:1em/1.25em Arial,sans-serif;display:block;padding:5px 15px!important;white-space:nowrap;background:#FFF}.b-share-popup__item,a.b-share-popup__item:link,a.b-share-popup__item:visited{text-decoration:none!important;border:0!important}a.b-share-popup__item{cursor:pointer}a.b-share-popup__item .b-share-popup__item__text{display:inline;text-decoration:underline;color:#1A3DC1}a.b-share-popup__item:hover{word-spacing:0}a.b-share-popup__item:hover .b-share-popup__item__text{color:red;cursor:pointer}.b-share-popup__icon{display:-moz-inline-box;display:inline-block;margin:-3px 0 0;padding:0 5px 0 0!important;vertical-align:middle}.b-share-popup__icon_input{width:21px;height:16px;margin-top:-6px;padding:0!important}.b-share-popup__icon__input{margin-right:0;margin-left:2px;vertical-align:top}.b-share-popup__spacer{display:block;padding-top:10px!important}.b-share-popup__header{font:86%/1em Verdana,sans-serif;display:block;padding:10px 15px 5px!important;color:#999}.b-share-popup__header_first{padding-top:5px!important}.b-share-popup__input{font:86%/1em Verdana,sans-serif;display:block;padding:5px 15px!important;color:#999;text-align:left}.b-share-popup__input__input{font:1em/1em Verdana,sans-serif;display:block;width:10px;margin:5px 0 0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;resize:none;text-align:left;direction:ltr}.b-share-popup_down .b-share-popup_with-link .b-share-popup__input_link{position:absolute;top:5px;right:0;left:0}.b-share-popup_up .b-share-popup_with-link .b-share-popup__input_link{position:absolute;right:0;bottom:5px;left:0}.b-share-popup_down .b-share-popup_with-link{padding-top:55px!important}.b-share-popup_up .b-share-popup_with-link{padding-bottom:55px!important}.b-share-popup_down .b-share-popup_expandable .b-share-popup__main{padding-bottom:25px!important}.b-share-popup_up .b-share-popup_expandable .b-share-popup__main{padding-top:25px!important}.b-share-popup_down .b-share-popup_yandexed{padding-bottom:10px!important}.b-share-popup_up .b-share-popup_yandexed{padding-top:10px!important}.b-share-popup__yandex{position:absolute;right:4px;bottom:2px;font:78.125%/1em Verdana,sans-serif;padding:3px!important;background:0 0}a.b-share-popup__yandex:link,a.b-share-popup__yandex:visited{color:#C6C5C5;text-decoration:none}a.b-share-popup__yandex:link:hover,a.b-share-popup__yandex:visited:hover{color:red;text-decoration:underline}.b-share-popup_up .b-share-popup__yandex{top:2px;bottom:auto}.b-share-popup_expandable .b-share-popup__yandex{right:auto;left:4px}.b-share-popup_to-right .b-share-popup_expandable .b-share-popup__yandex{right:4px;left:auto}.b-share-popup__expander .b-share-popup__item{position:absolute;bottom:5px;font:86%/1em Verdana,sans-serif;margin:10px 0 0;padding:5px 10px!important;cursor:pointer;color:#999;background:0 0}.b-share-popup_to-right,.b-share-popup_to-right .b-share-popup__expander{direction:rtl}.b-share-popup_to-right .b-share-popup__expander .b-share-popup__icon{padding:0 0 0 5px!important}.b-share-popup_up .b-share-popup__expander .b-share-popup__item{top:-5px;bottom:auto}.b-share-popup__expander .b-share-popup__item:hover .b-share-popup__item__text{text-decoration:underline}.b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup__expander .b-ico_action_larr,.b-share-popup_full .b-share-popup__expander .b-ico_action_larr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup__expander .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__item__text_expand{display:none}.b-share-popup_to-right .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_full .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_larr{display:inline}.b-ico_action_rarr,.b-ico_action_larr{width:8px;height:7px;border:0}.b-share-popup__main,.b-share-popup__extra{direction:ltr;vertical-align:bottom;text-align:left}.b-share-popup_down .b-share-popup__main,.b-share-popup_down .b-share-popup__extra{vertical-align:top}.b-share-popup__main{display:-moz-inline-stack;display:inline-block}.b-share-popup__extra{display:none;margin:0 -10px 0 0}.b-share-popup_full .b-share-popup__extra{display:-moz-inline-stack;display:inline-block}.b-share-popup_to-right .b-share-popup__extra{margin:0 0 0 -10px}.b-share-popup__tail{position:absolute;width:21px;height:10px;margin:0 0 0 -11px}.b-share-popup_down .b-share-popup__tail{top:-10px;background:url("//yastatic.net/share/static/b-share-popup_down__tail.gif") 0 0 no-repeat}.b-share-popup_up .b-share-popup__tail{bottom:-10px;background:url("//yastatic.net/share/static/b-share-popup_up__tail.gif") 0 0 no-repeat}.b-share-popup_down .b-share-popup__tail,x:nth-child(1){top:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.png")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1){bottom:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.png")}@media all and (resolution=0){.b-share-popup_down .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{top:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.gif")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{bottom:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.gif")}}.b-share-popup .b-share-popup_show_form_mail,.b-share-popup .b-share-popup_show_form_html{padding:0!important}.b-share-popup .b-share-popup_show_form_mail .b-share-popup__main,.b-share-popup .b-share-popup_show_form_html .b-share-popup__main,.b-share-popup .b-share-popup_show_form .b-share-popup__main,.b-share-popup .b-share-popup_show_form_mail .b-share-popup__extra,.b-share-popup .b-share-popup_show_form_html .b-share-popup__extra,.b-share-popup .b-share-popup_show_form .b-share-popup__extra{height:15px;padding:0!important;overflow:hidden;visibility:hidden}.b-share-popup_show_form_mail .b-share-popup__expander,.b-share-popup_show_form_html .b-share-popup__expander,.b-share-popup_show_form .b-share-popup__expander,.b-share-popup_show_form_mail .b-share-popup__input_link,.b-share-popup_show_form_html .b-share-popup__input_link,.b-share-popup_show_form .b-share-popup__input_link{display:none}.b-share-popup__form{position:relative;display:none;overflow:hidden;padding:5px 0 0!important;margin:0 0 -15px;white-space:normal}.b-share-popup_show_form_mail .b-share-popup__form_mail,.b-share-popup_show_form_html .b-share-popup__form_html,.b-share-popup_show_form .b-share-popup__form{display:block}.b-share-popup__form__link{padding:5px!important;margin:0 0 5px 10px;text-decoration:underline;cursor:pointer;color:#1A3DC1}.b-share-popup__form__link,.b-share-popup__form__button{font:86%/1.4545em Verdana,sans-serif;float:left;display:inline}.b-share-popup__form__button{margin:5px 0 0 15px}.b-share-popup__form__close{font:86%/1.4545em Verdana,sans-serif;float:right;display:inline;padding:5px!important;margin:0 10px 5px 0;cursor:pointer;color:#999}a.b-share-popup__form__link:hover,a.b-share-popup__form__close:hover{text-decoration:underline;color:red}.b-share-popup_font_fixed .b-share-popup__item{font-size:12.8px}.b-share-popup_font_fixed .b-share-popup__header,.b-share-popup_font_fixed .b-share-popup__input,.b-share-popup_font_fixed .b-share-popup__expander .b-share-popup__item,.b-share-popup_font_fixed .b-share-popup__form__link,.b-share-popup_font_fixed .b-share-popup__form__button,.b-share-popup_font_fixed .b-share-popup__form__close{font-size:11px}.b-share-popup_font_fixed .b-share-popup__yandex{font-size:10px}.b-share-form-button{font:86%/17px Verdana,Arial,sans-serif;display:-moz-inline-box;display:inline-block;position:relative;height:19px;margin:0 3px;padding:0 4px;cursor:default;white-space:nowrap;text-decoration:none!important;color:#000!important;border:none;outline:none;background:url("//yastatic.net/share/static/b-share-form-button.png") 0 -20px repeat-x}.b-share-form-button:link:hover,.b-share-form-button:visited:hover{color:#000!important}.b-share-form-button__before,.b-share-form-button__after{position:absolute;width:3px;height:19px;background:url("//yastatic.net/share/static/b-share-form-button.png")}.b-share-form-button__before{margin-left:-7px}.b-share-form-button__after{margin-left:4px;background-position:-3px 0}.b-share-form-button::-moz-focus-inner{border:none}button.b-share-form-button .b-share-form-button__before,button.b-share-form-button .b-share-form-button__after{margin-top:-1px}@-moz-document url-prefix(){button.b-share-form-button .b-share-form-button__after{margin-top:-2px;margin-left:6px}button.b-share-form-button .b-share-form-button__before{margin-top:-2px;margin-left:-9px}}SPAN.b-share-form-button:hover,.b-share-form-button_state_hover{background-position:0 -60px}SPAN.b-share-form-button:hover .b-share-form-button__before,.b-share-form-button_state_hover .b-share-form-button__before{background-position:0 -40px}SPAN.b-share-form-button:hover .b-share-form-button__after,.b-share-form-button_state_hover .b-share-form-button__after{background-position:-3px -40px}.b-share-form-button_state_pressed,.b-share-form-button_state_pressed .b-share-form-button_share{background-position:0 -100px!important}.b-share-form-button_state_pressed .b-share-form-button__before{background-position:0 -80px!important}.b-share-form-button_state_pressed .b-share-form-button__after{background-position:-3px -80px!important}button.b-share-form-button_state_pressed{overflow:visible}.b-share-form-button_icons{position:relative;padding:0;background-position:0 -20px!important}.b-share-form-button_icons .b-share-form-button__before{left:0;margin-left:-3px;background-position:0 0!important}.b-share-form-button_icons .b-share-form-button__after{z-index:-1;margin-left:0;background-position:-3px 0!important}.b-share-form-button_icons .b-share__handle{padding:2px!important}.b-share-form-button_icons .b-share__handle_more{position:relative;padding-right:6px!important;margin-right:-4px}.b-share-form-button_icons .b-share-icon{opacity:.5;background-image:url("//yastatic.net/share/static/b-share-icon_size_14.png")}.b-share-form-button_icons A.b-share__handle:hover .b-share-icon{opacity:1}.b-share{font:86%/1.4545em Arial,sans-serif;display:-moz-inline-box;display:inline-block;padding:1px 3px 1px 4px!important;vertical-align:middle}.b-share .b-share-form-button{font-size:1em}.b-share__text .b-share-icon{margin:0 5px 0 0;border:none}.b-share__text{margin-right:5px}.b-share__handle{float:left;height:16px;padding:5px 3px 5px 2px!important;cursor:pointer;text-align:left;text-decoration:none!important}.b-share__handle_cursor_default{cursor:default}.b-share__handle .b-share-form-button{margin-top:-2px}.b-share__hr{display:none;float:left;width:1px;height:26px;margin:0 3px 0 2px}a.b-share__handle:hover .b-share__text{text-decoration:underline;color:red}.b-share_bordered{padding:0 2px 0 3px!important;border:1px solid #E4E4E4;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}.b-share_bordered .b-share__hr{display:inline;background:#E4E4E4}.b-share_link{margin:-8px 0}a.b-share_link{margin:0}.b-share_link .b-share__text{text-decoration:underline;color:#1A3DC1}.b-share-form-button_share{padding-left:26px!important;vertical-align:top}.b-share-form-button_share .b-share-form-button__before{margin-left:-29px}.b-share-form-button_share .b-share-form-button__icon{position:absolute;width:20px;height:17px;margin:1px 0 0 -23px;background:url("//yastatic.net/share/static/b-share-form-button_share__icon.png") 0 0 no-repeat}.b-share-pseudo-link{border-bottom:1px dotted;cursor:pointer;text-decoration:none!important}.b-share_font_fixed{font-size:11px}.b-share__handle_more{font-size:9px;margin-top:-1px;color:#7B7B7B}A.b-share__handle_more:hover{color:#000}.b-share__group{float:left}.b-share-icon{float:left;display:inline;overflow:hidden;width:16px;height:16px;padding:0!important;vertical-align:top;border:0;background:url("//yastatic.net/share/static/b-share-icon.png") 0 99px no-repeat}.b-share-icon_vkontakte,.b-share-icon_custom{background-position:0 0}.b-share-icon_yaru,.b-share-icon_yaru_photo,.b-share-icon_yaru_wishlist{background-position:0 -17px}.b-share-icon_lj{background-position:0 -34px}.b-share-icon_twitter{background-position:0 -51px}.b-share-icon_facebook{background-position:0 -68px}.b-share-icon_moimir{background-position:0 -85px}.b-share-icon_friendfeed{background-position:0 -102px}.b-share-icon_mail{background-position:0 -119px}.b-share-icon_html{background-position:0 -136px}.b-share-icon_postcard{background-position:0 -153px}.b-share-icon_odnoklassniki{background-position:0 -170px}.b-share-icon_blogger{background-position:0 -187px}.b-share-icon_delicious{background-position:0 -221px}.b-share-icon_gbuzz{background-position:0 -238px}.b-share-icon_linkedin{background-position:0 -255px}.b-share-icon_myspace{background-position:0 -272px}.b-share-icon_evernote{background-position:0 -289px}.b-share-icon_digg{background-position:0 -306px}.b-share-icon_juick{background-position:0 -324px}.b-share-icon_moikrug{background-position:0 -341px}.b-share-icon_yazakladki{background-position:0 -358px}.b-share-icon_liveinternet{background-position:0 -375px}.b-share-icon_tutby{background-position:0 -392px}.b-share-icon_diary{background-position:0 -409px}.b-share-icon_gplus{background-position:0 -426px}.b-share-icon_pocket{background-position:0 -443px}.b-share-icon_surfingbird{background-position:0 -460px}.b-share-icon_pinterest{background-position:0 -477px}.b-share-icon_renren{background-position:0 0}.b-share-icon_renren,.b-share-icon_sina_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_sina_weibo{background-position:-18px 0}.b-share-icon_qzone{background-position:-36px 0}.b-share-icon_qzone,.b-share-icon_tencent_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_tencent_weibo{background-position:-54px 0}.b-share_theme_dark .b-share-icon{background:url("//yastatic.net/share/static/b-share-icons__theme_dark.png") 99px 0 no-repeat}.b-share_theme_dark .b-share-icon_odnoklassniki{background-position:-4px -3px}.b-share_theme_dark .b-share-icon_vkontakte{background-position:-24px -3px}.b-share_theme_dark .b-share-icon_twitter{background-position:-44px -3px}.b-share_theme_dark .b-share-icon_facebook{background-position:-64px -3px}.b-share_theme_dark .b-share-icon_lj{background-position:-85px -3px}.b-share_theme_dark .b-share-icon_yaru{background-position:-105px -3px}.b-share_theme_dark .b-share-popup .b-share-icon_odnoklassniki,.b-share_theme_dark .b-share-icon_odnoklassniki:hover{background-position:-4px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_vkontakte,.b-share_theme_dark .b-share-icon_vkontakte:hover{background-position:-24px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_twitter,.b-share_theme_dark .b-share-icon_twitter:hover{background-position:-44px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_facebook,.b-share_theme_dark .b-share-icon_facebook:hover{background-position:-64px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_lj,.b-share_theme_dark .b-share-icon_lj:hover{background-position:-85px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_yaru,.b-share_theme_dark .b-share-icon_yaru:hover{background-position:-105px -28px}.b-share_theme_dark .b-share-form-button_share .b-share-form-button__icon{background-image:url("//yastatic.net/share/static/b-share-form-button_share__icon_dark.png")}.b-share_theme_dark .b-share-form-button{color:#fff!important;opacity:.8}.b-share_theme_dark .b-share__handle:hover .b-share-form-button,.b-share_theme_dark .b-share-form-button:hover{opacity:1;cursor:pointer}.b-share_theme_dark .b-share-form-button,.b-share_theme_dark .b-share-form-button__before,.b-share_theme_dark .b-share-form-button__after{background:0 0}.b-share_theme_dark .b-share-popup__i{background-color:#333;border-radius:10px;-webkit-box-shadow:0 2px 9px rgba(255,255,255,.6);-moz-box-shadow:0 2px 9px rgba(255,255,255,.6);box-shadow:0 2px 9px rgba(255,255,255,.6)}.b-share_theme_dark .b-share__text{color:#AAA}.b-share_theme_dark .b-share-popup{color:#AAA;border-radius:10px;background-color:#333;background-color:rgba(50,50,50,.3)}.b-share_theme_dark .b-share-popup__item{background:0 0;color:#ccc}.b-share_theme_dark .b-share-popup .b-share-popup__item__text{color:#ccc}.b-share_theme_counter .b-share{display:inline-block;vertical-align:middle;white-space:nowrap}.b-share-counter{font:14px Arial,sans-serif;line-height:18px;display:none;float:left;margin:3px 6px 3px 3px;color:#fff}.b-share_theme_counter .b-share_type_small .b-share-counter{font-size:11px;line-height:14px;margin:2px 6px 2px 1px}.b-share_theme_counter .b-share-btn__counter .b-share-counter{display:block}.b-share-btn__counter{text-decoration:none}.b-share_theme_counter .b-share-btn__wrap{position:relative;float:left;margin-left:5px}.b-share_theme_counter .b-share_type_small .b-share-btn__wrap{margin-left:4px}.b-share_theme_counter .b-share-btn__wrap:first-child{margin-left:0}.b-share_theme_counter .b-share__link{display:inline-block;cursor:pointer;-webkit-border-radius:3px;border-radius:3px}.b-share_theme_counter .b-share_type_small .b-share__link{-webkit-border-radius:2px;border-radius:2px}.b-share_theme_counter .b-share-icon{display:block;float:left;width:24px;height:24px;background-image:url("//yastatic.net/share/static/b-share_counter_large.png");background-position:-20px 0}.b-share_theme_counter .b-share_type_small .b-share-icon{width:18px;height:18px;background-image:url("//yastatic.net/share/static/b-share_counter_small.png")}.b-share_theme_counter .b-share-icon_facebook{background-position:0 0}.b-share_theme_counter .b-share-btn__facebook{background-color:#3c5a98}.b-share_theme_counter .b-share-btn__facebook:hover{background-color:#30487a}.b-share_theme_counter .b-share-btn__facebook:active{border-top:2px solid #24365a;background-color:#334d81}.b-share_theme_counter .b-share-icon_moimir{background-position:0 -29px}.b-share_theme_counter .b-share-btn__moimir{background-color:#226eb7}.b-share_theme_counter .b-share-btn__moimir:hover{background-color:#1b5892}.b-share_theme_counter .b-share-btn__moimir:active{border-top:2px solid #14426d;background-color:#1d5e9c}.b-share_theme_counter .b-share-icon_vkontakte{background-position:0 -58px}.b-share_theme_counter .b-share-btn__vkontakte{background-color:#48729e}.b-share_theme_counter .b-share-btn__vkontakte:hover{background-color:#3a5b7e}.b-share_theme_counter .b-share-btn__vkontakte:active{border-top:2px solid #2b445e;background-color:#3d6186}.b-share_theme_counter .b-share-icon_twitter{background-position:0 -87px}.b-share_theme_counter .b-share-btn__twitter{background-color:#00aced}.b-share_theme_counter .b-share-btn__twitter:hover{background-color:#008abe}.b-share_theme_counter .b-share-btn__twitter:active{border-top:2px solid #00668d;background-color:#0092ca}.b-share_theme_counter .b-share-icon_odnoklassniki{background-position:0 -116px}.b-share_theme_counter .b-share-btn__odnoklassniki{background-color:#ff9f4d}.b-share_theme_counter .b-share-btn__odnoklassniki:hover{background-color:#cc7f3e}.b-share_theme_counter .b-share-btn__odnoklassniki:active{border-top:2px solid #975e2e;background-color:#d98742}.b-share_theme_counter .b-share-icon_gplus{background-position:0 -145px}.b-share_theme_counter .b-share-btn__gplus{background-color:#c25234}.b-share_theme_counter .b-share-btn__gplus:hover{background-color:#9b422a}.b-share_theme_counter .b-share-btn__gplus:active{border-top:2px solid #73311f;background-color:#a5462c}.b-share_theme_counter .b-share-icon_yaru{background-position:0 -174px}.b-share_theme_counter .b-share-btn__yaru{background-color:#d83933}.b-share_theme_counter .b-share-btn__yaru:hover{background-color:#ad2e29}.b-share_theme_counter .b-share-btn__yaru:active{border-top:2px solid #80221e;background-color:#b8312b}.b-share_theme_counter .b-share-icon_pinterest{background-position:0 -203px}.b-share_theme_counter .b-share-btn__pinterest{background-color:#cd1e27}.b-share_theme_counter .b-share-btn__pinterest:hover{background-color:#a4181f}.b-share_theme_counter .b-share-btn__pinterest:active{border-top:2px solid #7b1217;background-color:#ae1921}.b-share_theme_counter .b-share__link:active{height:22px}.b-share_theme_counter .b-share_type_small .b-share__link:active{height:16px}.b-share_theme_counter .b-share__link:active .b-share-icon,.b-share_theme_counter .b-share__link:active .b-share-counter{position:relative;top:-1px}.b-share_theme_counter .b-share__link::after{position:absolute;top:0;right:0;bottom:0;left:0;content:"";background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==)}.b-share_theme_counter .b-share__handle{height:auto;padding:0!important}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#1d3c78;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}</style></head>
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><span style="display:none;" class="csrf-token" data-csrf="f166c9ad168de66629c48afdd4741d0f">&nbsp;</span>
<div class="button-up" style="opacity: 0.7; width: 30px; height: 100%; position: fixed; left: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 30px; color: rgb(211, 219, 228); font-weight: bold; font-size: 20px; display: block;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile == "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>
<script type="text/javascript">
    window.fbAsyncInit = function() {
        FB.init({
            appId      : '554666954583323',
            xfbml      : true,
            version    : 'v2.8'
        });
        FB.AppEvents.logPageView();
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 1000
        });
    }, 0);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();

        var count = 0;

        function getDelay() {
            var delay = 0;
            var last = Codeforces.getFromStorage("LastOnlineTimeUpdaterMillis", 0);
            if (last && last != null) {
                var period = count < 20 ? 180 * 1000 : 360 * 1000;
                delay = period - (new Date().getTime() - last);
                if (delay < 0)
                    delay = 0;
            }
            return delay;
        }

        window.setInterval(function () {
            if (getDelay() <= 0 && count < 120) {
                ++count;
                Codeforces.ping("/data/update-online");
            }
        }, 5000);

        var handle = "24434";
        $("a.rated-user:contains(" + handle + "), span.participant:contains(" + handle + ")").each(function () {
            if ($(this).text() == handle) {
                var td = $(this).parent();
                var tr = $(this).parent().parent();
                if (td.is("td") && tr.is("tr")) {
                    tr.addClass("highlighted-row");
                }
            }
        });

    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }
        // console.log("Got announcement from channel");
        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");


    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; opacity: 0.7; width: 30px; position: fixed; right: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 30px; color: rgb(211, 219, 228); font-weight: bold; font-size: 10px; display: block;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>




<style>
    .header-bell {
        display: inline-block;
        position: relative;
        cursor: pointer;
    }

    .header-bell__img {
        opacity: 0.5;
        background-image: url("//st.codeforces.com/s/12135/images/icons/bell_inactive-20x20.png");
        position: relative;
        bottom: 1px;
        width: 20px;
        height: 20px;
    }

    .header-bell__img-active  {
        opacity: 1 !important;
        background-image: url("//st.codeforces.com/s/12135/images/icons/bell_active-20x20.png") !important;
    }

    .header-bell__count {
        position: absolute;
        top: 8px;
        left: 18px;
        font-weight: bold;
        font-size: 10px;
    }

    .bell-details {
        display: none;
        z-index: 5;
        border: 1px solid rgb(185, 185, 185);
        width: 40rem;
        max-height: 60rem;
        padding: 0;
        position: absolute;
        top: 20px;
        right: 0;
        background-color: white;
        overflow: scroll;
        overflow-x: hidden;
        overflow-y: auto;
    }
    .bell-details.sidebar-bell {
        position: fixed;
        right: 50px;
    }

    .bell-details__no-new {
        font-size: 1.3rem;
        display: block;
        text-align: center;
        color: #888 !important;
        padding: 1em;
    }

    .bell-details__recent-link {
        margin: 0;
        padding: 0.5em;
        text-align: center;
        border-top: 1px solid rgb(185, 185, 185);
    }

    .bell-details__recent-link a {
        font-size: 1.2rem;
    }

    .bell-details__proto-row-comment {
        display: none;
    }

    .bell-details__proto-row-blog-entry {
        display: none;
    }

    .bell-details__proto-row-comment-reply {
        display: none;
    }

    .bell-details__row {
        text-align: left;
        margin: 0.5em;
        padding: 0.25em 0.25em 0.75em 0.25em;
        clear: both;
    }

    .bell-details__row:hover {
        cursor: pointer;
        background-color: #def;
    }

    .bell-details__row-active {
        background-color: #def;
    }

    .bell-details__thumbnail-a {
        text-decoration: none;
    }

    .bell-details__row img {
        zoom: 50%;
        margin-right: 2em;
        float: left;
    }

    .bell-details__comment {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__blog-entry {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__comment-reply {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__time {
        padding-left: 45px;
        margin-top: 0.2em;
        font-size: 1.1rem;
        color: #888 !important;
    }
</style>

<script>
    $(function () {
        if ($(window).width() < 1600) {
            $('.side-bell').css('width', '30px').css('line-height', '30px').css('font-size', '10px');
        }

        if ($(window).width() >= 1200) {
            $ (window).scroll (function () {
                if ($ (this).scrollTop () > 100) {
                    $(".bell-details").addClass("sidebar-bell");
                    $ ('.side-bell').fadeIn();
                } else {
                    $(".bell-details").removeClass("sidebar-bell");
                    $ ('.side-bell').fadeOut();
                }
            });

            $('.side-bell').hover(function () {
                $(this).animate({
                    'opacity':'1'
                }).css({'color':'#6a86a4'});
            }, function () {
                $(this).animate({
                    'opacity':'0.7'
                }).css({'color':'#d3dbe4'});
            });
        }

        $(".lang-chooser>div:first-child").prepend($("<span style='position: relative; bottom: 8px; padding: 0 0.5em;'>|</span>")).prepend($(".header-bell").show());
        function Bell() {
            var bell = this;
            var notifications = JSON.parse("[]");

            bell.notifications = {};

            for (var i in notifications) {
                if (notifications.hasOwnProperty(i)) {
                    bell.notifications[notifications[i].id] = notifications[i];
                }
            }

            function onClick(notification) {
                var notificationIds = [];
                var reason = notification.data.reasonType + "#" + notification.reasonId;
                for (id in bell.notifications) {
                    if (bell.notifications.hasOwnProperty(id)) {
                        var otherNotification = bell.notifications[id];
                        var otherReason = otherNotification.data.reasonType + "#" + otherNotification.reasonId;
                        if (otherReason == reason) {
                            notificationIds.push(otherNotification.id);
                        }
                    }
                }
                $.post("/data/notification", {action: "markAsRead", notificationIds: notificationIds.join(",")}, function(result) {
                    Codeforces.redirect(notification.data.url);
                }, "json");
            }

            var $bellDetails = $(".bell-details");
            bell.newCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment").html(
                        "ReasonUser mentioned you in a comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newFriendCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment").html(
                        "ReasonUser wrote a comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newCommentReplyRow = function (notification) {
                var row = $(".bell-details__proto-row-comment-reply").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment-reply").html(
                        "ReasonUser replied to your comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment-reply");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newBlogEntryRow = function (notification) {
                var row = $(".bell-details__proto-row-blog-entry").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__blog-entry").html(
                        "ReasonUser mentioned you in a blog entry".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-blog-entry");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newFriendBlogEntryRow = function (notification) {
                var row = $(".bell-details__proto-row-blog-entry").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__blog-entry").html(
                        "ReasonUser wrote a blog entry".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-blog-entry");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newProposalCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment-reply").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment-reply").html(
                        "ReasonUser commented on ProposalType Proposal".replace("ReasonUser", notification.data.reasonUserHtml)
                                .replace("ProposalType", "Contest" == notification.data.proposalType ? "contest proposal" : "problem proposal")
                                .replace("Proposal", $("<div/>").text(notification.data.proposalName).html())
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment-reply");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };

            bell.renderRow = function (notification) {
                var $row = $(".bell-details__row[data-notificationId='" + notification.id + "']");

                if ($bellDetails.css("display") != "block" && notification.read) {
                    $row.hide();
                    return;
                }

                notification.data = JSON.parse(notification.dataJson);

                var reason = notification.data.reasonType + "#" + notification.reasonId;

                var has = false;
                $row.each(function () {
                    has = true;
                });
                if ($(".bell-details__row[data-reason='" + reason + "']").length) {
                    has = true;
                }

                if (!has) {
                    $(".side-bell").css("visibility", "visible");
                    var newRow;
                    if (notification.type == "Comment") {
                        newRow = bell.newCommentRow(notification);
                    } else if (notification.type == "BlogEntry") {
                        newRow = bell.newBlogEntryRow(notification);
                    } else if (notification.type == "CommentReply") {
                        newRow = bell.newCommentReplyRow(notification);
                    } else if (notification.type == "FriendComment") {
                        newRow = bell.newFriendCommentRow(notification);
                    } else if (notification.type == "FriendBlogEntry") {
                        newRow = bell.newFriendBlogEntryRow(notification);
                    } else if (notification.type == "ProposalComment") {
                        newRow = bell.newProposalCommentRow(notification)
                    }
                    if (newRow) {
                        newRow.attr("data-reason", reason);
                        $(".bell-details").prepend(newRow);
                    }
                }
            };

            var $count = $(".header-bell__count, .side-bell__count");
            var $img = $(".header-bell__img");
            var $noNew = $(".bell-details__no-new");

            bell.renewCount = function () {
                Codeforces.reformatTimes();
                var count = 0;
                var counted = {};
                for (var id in bell.notifications)
                    if (bell.notifications.hasOwnProperty(id)) {
                        var notification = bell.notifications[id];
                        if (notification) {
                            var reason = notification.data.reasonType + "#" + notification.reasonId;
                            if (!notification.read && !counted[reason]) {
                                count++;
                                counted[reason] = true;
                            }
                        }
                    }
                if (count > 0) {
                    $count.text(count);
                    $img.addClass("header-bell__img-active");
                    $noNew.hide();
                } else {
                    $count.text("");
                    $img.removeClass("header-bell__img-active");
                    if ($bellDetails.css("display") != "block") {
                        $noNew.show();
                    }
                }
            };

            for (var id in bell.notifications)
                if (bell.notifications.hasOwnProperty(id))
                    bell.renderRow(bell.notifications[id]);

            if (window.eventCatcher) {
                window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                    if (json.t === "n") {
                        for (var i in json.d)
                            if (json.d.hasOwnProperty(i)) {
                                var notification = json.d[i];
                                notification.data = JSON.parse(notification.dataJson);
                                bell.notifications[notification.id] = notification;
                                bell.renderRow(notification);
                                bell.renewCount();
                            }
                    }
                });
            }


            $(".header-bell, .side-bell").click(function() {
                if ($bellDetails.css("display") == "none") {
                    for (var id in bell.notifications)
                        if (bell.notifications.hasOwnProperty(id))
                            if (bell.notifications[id].read)
                                bell.renderRow(bell.notifications[id]);
                    bell.renewCount();

                    $bellDetails.css("display", "block");

                    var notificationIds = [];
                    for (id in bell.notifications)
                        if (bell.notifications.hasOwnProperty(id))
                            notificationIds.push(id);

                    setTimeout(function() {
                        if ($bellDetails.css("display") == "block") {
                            $.post("/data/notification", {action: "markAsRead", notificationIds: notificationIds.join(",")}, function(result) {
                                // No operations.
                            }, "json");

                            for (var i in notificationIds) {
                                if (notificationIds.hasOwnProperty(i)) {
                                    bell.notifications[notificationIds[i]].read = true;
                                }
                            }
                            bell.renewCount();
                        }
                    }, 2000);
                } else {
                    var has = false;
                    for (var id in bell.notifications) {
                        if (bell.notifications.hasOwnProperty(id) && !bell.notifications[id].read) {
                            has = true;
                        }
                    }
                    if (!has) {
                        $(".side-bell").css("visibility", "hidden");
                    }
                    $bellDetails.css("display", "none");
                    bell.renewCount();
                }
            });
        }

        bell = new Bell();
        bell.renewCount();
    })
</script>

<div id="header" style="position: relative;">
    <div style="float:left;">
            <a href="https://codeforces.com/"><img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/codeforces-logo-with-telegram.png"></a>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;"><div class="header-bell" style="">
    <div class="header-bell__img"><span class="header-bell__count"></span></div>

    <div class="bell-details sidebar-bell">
        <div class="bell-details__proto-row-comment">
            <a class="bell-details__thumbnail-a" href="#"><img src=""></a>
            <div class="bell-details__comment"></div>
            <div class="bell-details__time"></div>
        </div>
        <div class="bell-details__proto-row-blog-entry">
            <a class="bell-details__thumbnail-a" href="#"><img src=""></a>
            <div class="bell-details__blog-entry"></div>
            <div class="bell-details__time"></div>
        </div>
        <div class="bell-details__proto-row-comment-reply">
            <a class="bell-details__thumbnail-a" href="#"><img src=""></a>
            <div class="bell-details__comment-reply"></div>
        </div>

        <div class="bell-details__no-new">
            There are no new notifications
        </div>

        <div class="bell-details__recent-link">
            <a href="https://codeforces.com/notifications">History (at most 100 notifications)</a>
        </div>
    </div>
</div><span style="position: relative; bottom: 8px; padding: 0 0.5em;">|</span>
            <a href="https://codeforces.com/blog/entry/44351?locale=en"><img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/gb.png" title="In English" alt="In English"></a>
            <a href="https://codeforces.com/blog/entry/44351?locale=ru"><img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/ru.png" title="По-русски" alt="По-русски"></a>
        </div>

        <div>
                        <a href="https://codeforces.com/profile/24434">24434</a>
                     | 
                        <a href="https://codeforces.com/b6c1070ac27615192fdb958f9e942018/logout">Logout</a>
                    
        </div>



    </div>
    <br style="clear: both;">
</div>
        

    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="https://codeforces.com/">Home</a></li>
                <li class=""><a href="https://codeforces.com/top">Top</a></li>
                <li class=""><a href="https://codeforces.com/contests">Contests</a></li>
                <li class=""><a href="https://codeforces.com/gyms">Gym</a></li>
                <li class=""><a href="https://codeforces.com/problemset">Problemset</a></li>
                <li class=""><a href="https://codeforces.com/groups">Groups</a></li>
                <li class=""><a href="https://codeforces.com/ratings">Rating</a></li>
                <li class=""><a href="https://codeforces.com/api/help">API</a></li>
                <li class=""><a href="https://codeforces.com/help">Help</a></li>
                <li class=""><a href="https://codeforces.com/ffc">Forethought Future Cup <img class="icon" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cup.png"></a></li>
                <li class=""><a href="https://codeforces.com/calendar">Calendar</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="f166c9ad168de66629c48afdd4741d0f">
            <input class="search" name="query" data-isplaceholder="true">
        <input type="hidden" name="_tta" value="577"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
            <div style="margin:1em;text-align: center;" class="alert alert-warning">
                <i class="icon-info"></i> Your password is extremely weak or has been leaked (see <a href="https://haveibeenpwned.com/">https://haveibeenpwned.com/</a>).
Please, <a href="https://codeforces.com/settings/general">change it</a> ASAP.
            </div>
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;border-bottom: 1px solid rgb(185, 185, 185);margin:0 -0.5em 0.5em -0.5em;padding: 0 1em 0.5em 1em;">
            <span class="contest-state-phase">Before contest</span><br><a href="https://codeforces.com/contests/1157">Codeforces Round #555 (Div. 3)</a><br><span class="countdown" home="//st.codeforces.com/s/12135" noredirection="true" textbeforeredirect="" cdid="i1">00:56:22</span>
        </div>
        <div style="text-align:center;">
            <div class="socials" style="text-align: left;">
                <div style="margin-top: 0.85em;position: relative;">

        <div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div><iframe name="fb_xdm_frame_https" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/d_vbiawPdxB.html" frameborder="0"></iframe></div><div></div></div></div>
        <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_EN/all.js#appId=554666954583323&xfbml=1";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        </script>
        <div class="fb-like fb_iframe_widget" data-href="//codeforces.com/contests/1157" data-send="false" data-width="256" data-show-faces="false" data-font="arial" data-ref="1508546" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=554666954583323&amp;container_width=264&amp;font=arial&amp;href=https%3A%2F%2Fcodeforces.com%2Fcontests%2F1157&amp;locale=en_US&amp;ref=1508546&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=256"><span style="vertical-align: bottom; width: 256px; height: 28px;"><iframe name="f628c79eb67c52" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" title="fb:like Facebook Social Plugin" style="border: medium none; visibility: visible; width: 256px; height: 28px;" src="https://web.facebook.com/v2.8/plugins/like.php?app_id=554666954583323&amp;channel=https%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2Fd_vbiawPdxB.js%3Fversion%3D44%23cb%3Df3c8f6069cd6b1a%26domain%3Dcodeforces.com%26origin%3Dhttps%253A%252F%252Fcodeforces.com%252Ff198616f5189176%26relation%3Dparent.parent&amp;container_width=264&amp;font=arial&amp;href=https%3A%2F%2Fcodeforces.com%2Fcontests%2F1157&amp;locale=en_US&amp;ref=1508546&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=256" class="" width="256px" height="1000px" frameborder="0"></iframe></span></div>

        </div>
</div>

        </div>
</div>
    </div>

    <style>
        .personal-sidebar {
            margin: 1em;
        }

        .personal-sidebar .for-avatar {
            float: right;
        }

        .personal-sidebar li {
            font-size: 0.8em;
        }

        .personal-sidebar .nav-links {
            margin-top: 0.5em;
        }

        .personal-sidebar .nav-links li {
            list-style: disc;
            list-style-position: inside;
        }
    </style>

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ 24434
            <div class="top-links">
            </div>
        </div>
    <div class="personal-sidebar">
<div class="for-avatar"><div class="avatar"><a href="https://codeforces.com/profile/24434" style="position: relative;"><img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/c7a705f60ecae457.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px"></a><div><a href="https://codeforces.com/profile/24434" title="Candidate Master 24434" class="rated-user user-violet">24434</a></div></div></div><div><ul><li><img style="vertical-align:middle;position:relative;top:-0.2em;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/rating-16x16.png" alt="User''s contest rating in Codeforces community" title="User''s contest rating in Codeforces community">&nbsp;

        Rating:&nbsp;<span style="font-weight:bold;" class="user-violet">2047</span></li><li><img style="vertical-align:middle;position:relative;top:-0.2em;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_blue_16.png" alt="User''s contribution into Codeforces community" title="User''s contribution into Codeforces community">&nbsp;

        Contribution:&nbsp;<span style="color:gray;font-weight:bold;">0</span></li></ul><ul class="nav-links"><li><a href="https://codeforces.com/settings/general">Settings</a></li><li><a href="https://codeforces.com/blog/24434">Blog</a></li><li><a href="https://codeforces.com/teams">Teams</a></li><li><a href="https://codeforces.com/submissions/24434">Submissions</a></li><li><a href="https://codeforces.com/proposals/new-contest">Propose a contest/problems</a></li><li><a href="https://codeforces.com/usertalk">Talks</a></li><li><a href="https://codeforces.com/contests/with/24434">Contests</a></li></ul></div><br style="clear:both;">    </div>
    </div>

<div class="roundbox sidebox top-contributed" style="">
<div class="roundbox-lt">&nbsp;</div>
<div class="roundbox-rt">&nbsp;</div>
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="https://codeforces.com/profile/tourist" title="Legendary grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class=" dark">3698</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="https://codeforces.com/profile/Um_nik" title="Legendary grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
<td class="">3463</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="https://codeforces.com/profile/Petr" title="Legendary grandmaster Petr" class="rated-user user-legendary"><span class="legendary-user-first-letter">P</span>etr</a></td>
<td class=" dark">3341</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="https://codeforces.com/profile/wxhtxdy" title="Legendary grandmaster wxhtxdy" class="rated-user user-legendary"><span class="legendary-user-first-letter">w</span>xhtxdy</a></td>
<td class="">3329</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="https://codeforces.com/profile/LHiC" title="Legendary grandmaster LHiC" class="rated-user user-legendary"><span class="legendary-user-first-letter">L</span>HiC</a></td>
<td class=" dark">3300</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="https://codeforces.com/profile/ecnerwala" title="Legendary grandmaster ecnerwala" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>cnerwala</a></td>
<td class="">3285</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="https://codeforces.com/profile/sunset" title="Legendary grandmaster sunset" class="rated-user user-legendary"><span class="legendary-user-first-letter">s</span>unset</a></td>
<td class=" dark">3278</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="https://codeforces.com/profile/V--o_o--V" title="Legendary grandmaster V--o_o--V" class="rated-user user-legendary"><span class="legendary-user-first-letter">V</span>--o_o--V</a></td>
<td class="">3275</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="https://codeforces.com/profile/Benq" title="Legendary grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class=" dark">3262</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="https://codeforces.com/profile/mnbvmar" title="Legendary grandmaster mnbvmar" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>nbvmar</a></td>
<td class="bottom">3248</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://codeforces.com/ratings/countries">Countries</a> |
<a href="https://codeforces.com/ratings/cities">Cities</a> |
<a href="https://codeforces.com/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="https://codeforces.com/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>

    <div class="roundbox sidebox top-contributed" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/Radewoosh" title="Legendary grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
                                <td class=" dark">187</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="https://codeforces.com/profile/Errichto" title="International Grandmaster Errichto" class="rated-user user-red">Errichto</a></td>
                                <td class="">180</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/rng_58" title="Legendary grandmaster rng_58" class="rated-user user-legendary"><span class="legendary-user-first-letter">r</span>ng_58</a></td>
                                <td class=" dark">161</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="https://codeforces.com/profile/PikMike" title="Master PikMike" class="rated-user user-orange">PikMike</a></td>
                                <td class="">160</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/Vovuh" title="Candidate Master Vovuh" class="rated-user user-violet">Vovuh</a></td>
                                <td class=" dark">157</td>
                    </tr>
                    <tr>
                                <td class="left ">5</td>
                                <td class=""><a href="https://codeforces.com/profile/Petr" title="Legendary grandmaster Petr" class="rated-user user-legendary"><span class="legendary-user-first-letter">P</span>etr</a></td>
                                <td class="">157</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/300iq" title="Legendary grandmaster 300iq" class="rated-user user-legendary"><span class="legendary-user-first-letter">3</span>00iq</a></td>
                                <td class=" dark">151</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="https://codeforces.com/profile/Ashishgup" title="Master Ashishgup" class="rated-user user-orange">Ashishgup</a></td>
                                <td class="">149</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/majk" title="International Grandmaster majk" class="rated-user user-red">majk</a></td>
                                <td class=" dark">148</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="https://codeforces.com/profile/Swistakk" title="International Grandmaster Swistakk" class="rated-user user-red">Swistakk</a></td>
                                <td class="bottom">147</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="https://codeforces.com/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>



    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="f166c9ad168de66629c48afdd4741d0f">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="577"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocomplete("/data/handles", {
        delay: 200,
        width: 200,
        selectFirst: false,
        matchContains: true,
        minChars: 3
    });
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>




    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/_ICHIGO__KUROSAKI_" title="Newbie _ICHIGO__KUROSAKI_" class="rated-user user-gray">_ICHIGO__KUROSAKI_</a>        →
        <a href="https://codeforces.com/blog/entry/66720">An easy approach for the question 1152B. Neko Performs Cat Furrier Transform</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Vovuh" title="Candidate Master Vovuh" class="rated-user user-violet">Vovuh</a>        →
        <a href="https://codeforces.com/blog/entry/66703">Codeforces Round #555 (Div. 3)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/anancodec" title="Newbie anancodec" class="rated-user user-gray">anancodec</a>        →
        <a href="https://codeforces.com/blog/entry/66697">Why my rating is decreasing in proportion of the increasing of my practice?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Akikaze" title="Expert Akikaze" class="rated-user user-blue">Akikaze</a>        →
        <a href="https://codeforces.com/blog/entry/66696">Codeforces Round #554 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/robot-dreams" title="Master robot-dreams" class="rated-user user-orange">robot-dreams</a>        →
        <a href="https://codeforces.com/blog/entry/66715">Improving efficiently: beyond "just solve more problems"?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/justHusam" title="Candidate Master justHusam" class="rated-user user-violet">justHusam</a>        →
        <a href="https://codeforces.com/blog/entry/66219">[Gym] 2019 JUST Programming Contest</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Deemo" title="International Grandmaster Deemo" class="rated-user user-red">Deemo</a>        →
        <a href="https://codeforces.com/blog/entry/66699">Looking for training-mate</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Master_coder" title="Pupil Master_coder" class="rated-user user-green">Master_coder</a>        →
        <a href="https://codeforces.com/blog/entry/66716">need help </a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/stefdasca" title="Candidate Master stefdasca" class="rated-user user-violet">stefdasca</a>        →
        <a href="https://codeforces.com/blog/entry/62775">Is listening to Twice boosting cp skills?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/PikMike" title="Master PikMike" class="rated-user user-orange">PikMike</a>        →
        <a href="https://codeforces.com/blog/entry/66647">Educational Codeforces Round 63 [Rated for Div. 2]</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/ParagonX97" title="Specialist ParagonX97" class="rated-user user-cyan">ParagonX97</a>        →
        <a href="https://codeforces.com/blog/entry/61770">A Shortest Path Problem</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/low_" title="Candidate Master low_" class="rated-user user-violet">low_</a>        →
        <a href="https://codeforces.com/blog/entry/66667">Dreadful days...</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/LogitechSellout" title="Unrated, LogitechSellout" class="rated-user user-black">LogitechSellout</a>        →
        <a href="https://codeforces.com/blog/entry/66713">Why TLE even though time complexity is ok (DP)?</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/E869120" title="Grandmaster E869120" class="rated-user user-red">E869120</a>        →
        <a href="https://codeforces.com/blog/entry/53341">[Tutorial] A Way to Practice Competitive Programming : From rating 1000 to 2000</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/MrPoJ" title="Unrated, MrPoJ" class="rated-user user-black">MrPoJ</a>        →
        <a href="https://codeforces.com/blog/entry/59935">Knuth-Moriss-Pratt Algorithm </a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/satillendlim" title="Pupil satillendlim" class="rated-user user-green">satillendlim</a>        →
        <a href="https://codeforces.com/blog/entry/66702">I need a hint</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Kvark161" title="Master Kvark161" class="rated-user user-orange">Kvark161</a>        →
        <a href="https://codeforces.com/blog/entry/18247">The youngest grandmasters</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/HolkinPV" title="Candidate Master HolkinPV" class="rated-user user-violet">HolkinPV</a>        →
        <a href="https://codeforces.com/blog/entry/14849">Codeforces Round #279 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/qqqqq43" title="Unrated, qqqqq43" class="rated-user user-black">qqqqq43</a>        →
        <a href="https://codeforces.com/blog/entry/65829">Road to Blue on CF.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/MikeMirzayanov" title="Headquarters, MikeMirzayanov" class="rated-user user-admin">MikeMirzayanov</a>        →
        <a href="https://codeforces.com/blog/entry/18291">Генераторы на testlib.h</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/cheater_killer" title="Unrated, cheater_killer" class="rated-user user-black">cheater_killer</a>        →
        <a href="https://codeforces.com/blog/entry/66677">Multiple cheating cases by same users</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/aryanc403" title="Candidate Master aryanc403" class="rated-user user-violet">aryanc403</a>        →
        <a href="https://codeforces.com/blog/entry/66704">Topcoder SRM 756 — Starts in 30 Min.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Akikaze" title="Expert Akikaze" class="rated-user user-blue">Akikaze</a>        →
        <a href="https://codeforces.com/blog/entry/66587">Codeforces Round #554 (Div. 2)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Yousry" title="Expert Yousry" class="rated-user user-blue">Yousry</a>        →
        <a href="https://codeforces.com/blog/entry/61444">Egyptian Olympiad in Informatics — Open Contests Archive (IOI style problems)</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/scott_wu" title="International Grandmaster scott_wu" class="rated-user user-red">scott_wu</a>        →
        <a href="https://codeforces.com/blog/entry/66303">ICPC Connections, Porto edition</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="https://codeforces.com/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 38.5px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="https://codeforces.com/profile/Arpa">Arpa</a></li>
        <li class="current selectedLava"><a href="https://codeforces.com/blog/Arpa">Blog</a></li>
        <li><a href="https://codeforces.com/teams/with/Arpa">Teams</a></li>
        <li><a href="https://codeforces.com/submissions/Arpa">Submissions</a></li>
        <li><a href="https://codeforces.com/groups/with/Arpa">Groups</a></li>
        <li><a href="https://codeforces.com/contests/with/Arpa">Contests</a></li>
        <li><a href="https://codeforces.com/contests/writer/Arpa">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="https://codeforces.com/blog/Arpa" style="text-decoration:none;color:black !important;">Arpa's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="topic" topicid="44511">
    <div class="title">
            <a href="https://codeforces.com/blog/entry/44351">            <p>[Tutorial] Sack (dsu on tree)</p>
</a>
    </div>

    <div class="info" style="position:relative;">
            By&nbsp;<a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a>,
                <a href="https://codeforces.com/topic/44511/en42">history</a>,
                <span class="format-humantime" title="Apr/14/2016 23:11 UTC+7">3 years ago</span>,
            
            <img style="position: relative;top: 5px;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/gb.png" alt="In English" title="In English">,

<a class="attach-blogEntry-44351-to-contest-link" href="#"><img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/paperclip-16x16.png" title="Attach this blog to some contest as a resource"></a>

<style type="text/css">
    .attach-blogEntry-44351-to-contest-form tr:not(:last-of-type) td {
        padding-bottom: 1em;
    }

    .blogEntry-44351-error {
        font-size: 1.1rem;
    }
</style>

<div class="attach-blogEntry-44351-to-contest-form-holder" style="display: none;padding: 1em;margin: 1em;">
    <form class="attach-blogEntry-44351-to-contest-form" method="post"><input type="hidden" name="csrf_token" value="f166c9ad168de66629c48afdd4741d0f">
        <table style="width: 100%;">
            <thead>
            </thead>
            <tbody>
        <tr class="subscription-row blogEntry-44351-blogId-error blogEntry-44351-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-44351-blogId">-</span>
</div></td>
        </tr>
            <tr>
                <td style="width: 30%;"><label for="blogEntry-44351-contestId">Contest:</label></td>
                <td>
                    <input type="text" style="width: 100%;float: left;" id="blogEntry-44351-contestId" name="contestIdAndName">
                </td>
                <td>
                </td>
            </tr>
        <tr class="subscription-row blogEntry-44351-contestId-error blogEntry-44351-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-44351-contestId">-</span>
</div></td>
        </tr>
            <tr>
                <td style="width: 30%;"><label for="blogEntry-44351-resourceType">Type:</label></td>
                <td>
                    <select id="blogEntry-44351-resourceType" name="resourceType" style="width: 100%;">
                        <option value="" selected="selected"></option>
                        <option value="STATEMENT">statements</option>
                        <option value="TUTORIAL">tutorial</option>
                        <option value="ANNOUNCEMENT">announcement</option>
                        <option value="DISCUSSION">discussion</option>
                    </select>
                </td>
                <td></td>
            </tr>
        <tr class="subscription-row blogEntry-44351-resourceType-error blogEntry-44351-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-44351-resourceType">-</span>
</div></td>
        </tr>
            <tr>
                <td colspan="2" style="text-align: center;">
                    <input type="submit" id="blogEntry-44351-resource-submit" value="Attach" style="padding: 0.25em 0.5em;margin: 1em;width: 8em;">
                </td>
                <td>
                    <img id="blogEntry-44351-resource-submitting-indicator" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/indicator.gif" style="display: none;">
                </td>
            </tr>
            </tbody>
        </table>
    <input type="hidden" name="_tta" value="577"></form>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $(".blogEntry-44351-error").hide();

        $(".attach-blogEntry-44351-to-contest-link").click(function () {
            Codeforces.facebox(".attach-blogEntry-44351-to-contest-form-holder", "//st.codeforces.com/s/12135");

            var popupContestInput = $("#facebox input[name=contestIdAndName]");
            popupContestInput.autocomplete("/data/contests?action=suggestContestWithEditableResources", {
                delay: 200,
                width: 500,
                selectFirst: false,
                matchContains: true,
                scroll: true,
                max: 150,
                minChars: 2
            });

            $("#facebox .attach-blogEntry-44351-to-contest-form").submit(function () {
                var contestId = popupContestInput.attr("value").trim().split(/[\- ]/)[0];
                if (contestId !== undefined) {
                    $("#facebox .blogEntry-44351-error").hide();
                    $("#facebox #blogEntry-44351-resource-submitting-indicator").show();
                    $("#facebox #blogEntry-44351-resource-submit").attr("disabled", "disabled");

                    //noinspection JSUnusedGlobalSymbols
                    $.post("/data/blogAndContest?action=attachBlogToContest", {
                        blogId:"20412", contestId:contestId,
                        blogEntryId:"44351",
                        resourceType:$("#facebox #blogEntry-44351-resourceType").val()
                    }, function (json) {
                        var validated = true;

                        for (var key in json) {
                            if (json.hasOwnProperty(key) && key.indexOf("error__") === 0) {
                                validated = false;
                                $("#facebox .blogEntry-44351-" + key.substring("error__".length) + "-error").show();
                                $("#facebox .for__blogEntry-44351-" + key.substring("error__".length)).text(json[key]);
                            }
                        }

                        $("#facebox #blogEntry-44351-resource-submitting-indicator").hide();
                        $("#facebox #blogEntry-44351-resource-submit").removeAttr("disabled");

                        if (validated) {
                            $.facebox.close();
                            if (json["success"] === "true") {
                                Codeforces.showMessage("Blog has been successfully attached to selected contest");
                            } else {
                                Codeforces.showMessage("There is unexpected error while attaching blog to the contest");
                            }
                        }
                    }, "json");
                }

                return false;
            });


            return false;
        });
    });
</script>



        <span style="position:absolute;right:0;top:0.05em;margin-right:1em;display:inline;font-size:0.75em;">
            <div style="margin-top:0.25em;">
            </div>
        </span>
    </div>

    <div class="content">
        <div class="ttypography"><p><strong>Changes are available in history section.</strong></p><p>Hi!</p><p>Most of the people know about dsu but what is the "dsu on tree"?</p><p>In Iran, we call this technique "Guni" (the word means "sack" in English), instead of "dsu on tree".</p><p>I will explain it and post ends with several problems in CF that can be solved by this technique.</p><h1>What is the dsu on tree?</h1><p>With dsu on tree we can answer queries of this type:</p><p>How many vertices in the subtree of vertex <code class="tt">v</code> has some property in <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/9233e5a9ea86381add3ad78777a93e32e45fa5b8.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> time (for all of the queries)?</p><p>For example:</p><p>Given a tree, every vertex has color. Query is <strong>how many vertices in subtree of vertex <code class="tt">v</code> are colored with color <code class="tt">c</code>?</strong></p><p>Let's see how we can solve this problem and similar problems.</p><p>First, we have to calculate the size of the subtree of every vertice. It can be done with simple dfs:</p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> getsz</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
    sz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">  </span><span class="com">// every vertex has itself in its subtree</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
            getsz</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
            sz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln"> </span><span class="com">// add size of child u to its parent(v)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Now we have the size of the subtree of vertex <code class="tt">v</code> in <code class="tt">sz[v]</code>.</p><p>The naive method for solving that problem is this code(that works in O(N ^ 2) time)</p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u</span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
            add</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
    add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="com">//now cnt[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Now, how to improve it? There are several styles of coding for this technique.</p><h3>1. easy to code but <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/ca4c38da7d143fc87534d50aa6d551dd861caae9.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</h3> <pre><code class="prettyprint"><span class="pln">map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
           dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
           </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
               mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
       </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">();</span><span class="pln">
    </span><span class="pun">(*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               </span><span class="pun">(*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])[</span><span class="pln">x</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
       </span><span class="pun">}</span><span class="pln">
    </span><span class="com">//now (*cnt[v])[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">

</span><span class="pun">}</span></code></pre><h3>2. easy to code and <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</h3> <pre><code class="prettyprint"><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> keep</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
           mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
           dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        dfs</span><span class="pun">(</span><span class="pln">bigChild</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vec</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln">
        vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="pun">();</span><span class="pln">
    vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-&gt;</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]){</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
               vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
           </span><span class="pun">}</span><span class="pln">
    </span><span class="com">//now (*cnt[v])[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    </span><span class="com">// note that in this step *vec[v] contains all of the subtree of vertex v.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]--;</span><span class="pln">
</span><span class="pun">}</span></code></pre><h3>3. heavy-light decomposition style <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</h3> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> big</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u</span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">big</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
            add</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> keep</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
          mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">  </span><span class="com">// run a dfs on small childs and clear them from cnt</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        dfs</span><span class="pun">(</span><span class="pln">bigChild</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> big</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">  </span><span class="com">// bigChild marked as big and not cleared from cnt</span><span class="pln">
    add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="com">//now cnt[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        big</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre><h3>4. My invented style <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</h3><p>This
 implementation for "Dsu on tree" technique is new and invented by me. 
This implementation is easier to code than others. Let <span class="tex-span"><i>st</i>[<i>v</i>]</span> dfs starting time of vertex <span class="tex-span"><i>v</i></span>, <span class="tex-span"><i>ft</i>[<i>v</i>]</span> be it's finishing time and <span class="tex-span"><i>ver</i>[<i>time</i>]</span> is the vertex which it's starting time is equal to <span class="tex-span"><i>time</i></span>.</p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> keep</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
          mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">  </span><span class="com">// run a dfs on small childs and clear them from cnt</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        dfs</span><span class="pun">(</span><span class="pln">bigChild</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">  </span><span class="com">// bigChild marked as big and not cleared from cnt</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
	    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> st</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln"> p </span><span class="pun">&lt;</span><span class="pln"> ft</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln">
		cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln"> ver</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
    </span><span class="com">//now cnt[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> st</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln"> p </span><span class="pun">&lt;</span><span class="pln"> ft</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln">
	    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln"> ver</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">]--;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>But why it is <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">? You know that why dsu has <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/0f239d055af9bea3474df8b031eb77f1e3db2398.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> time (for <span class="tex-span"><i>q</i></span> queries); the code uses the same method. Merge smaller to greater.</p><p>If you have heard <code class="tt">heavy-light decomposition</code> you will see that function <code class="tt">add</code> will go light edges only, because of this, code works in <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> time.</p><p>Any problems of this type can be solved with same <code class="tt">dfs</code> function and just differs in <code class="tt">add</code> function.</p><p>Hmmm, this is what you want, problems that can be solved with this technique:</p><p>(List is sorted by difficulty and my code for each problem is given, my codes has <code class="tt">heavy-light</code> style)</p><p><a href="https://codeforces.com/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a> : <code class="tt">heavy-light decomposition</code> style : <a href="https://paste.ubuntu.com/p/z7792STp56/">Link</a>, easy style : <a href="https://paste.ubuntu.com/p/7VRXTsTjdv/">Link</a>. I think this is the easiest problem of this technique in CF and it's good to start coding with this problem.</p><p><a href="https://codeforces.com/contest/570/problem/D" title="Codeforces Round 316 (Div. 2)">570D - Tree Requests</a> : <a href="https://codeforces.com/contest/570/submission/17961189" title="Submission 17961189 by Arpa">17961189</a> Thanks to <a class="rated-user user-blue" href="https://codeforces.com/profile/Sorasorasora" title="Expert Sorasorasora">Sorasorasora</a>; this problem is also good for start coding.</p><p><a href="http://acm.sgu.ru/problem.php?contest=0&amp;problem=507">Sgu507</a> (SGU is unavailable, read the problem statements <a href="https://vjudge.net/problem/SGU-507">here</a>) This problem is also good for the start.</p><p><a href="https://www.hackerearth.com/practice/algorithms/graphs/depth-first-search/practice-problems/algorithm/the-grass-type/">HackerEarth, The Grass Type</a> This problem is also good for start (See <a class="rated-user user-cyan" href="https://codeforces.com/profile/bhishma" title="Specialist bhishma">bhishma</a>'s comment <a href="#comment-332421">below</a>).</p><p><a href="https://codeforces.com/contest/246/problem/E" title="Codeforces Round 151 (Div. 2)">246E - Blood Cousins Return</a> : <a href="https://codeforces.com/contest/246/submission/15409328" title="Submission 15409328 by Arpa">15409328</a></p><p><a href="https://codeforces.com/contest/208/problem/E" title="Codeforces Round 130 (Div. 2)">208E - Blood Cousins</a> : <a href="https://codeforces.com/contest/208/submission/16897324" title="Submission 16897324 by Arpa">16897324</a></p><p><a href="http://www.ioinformatics.org/locations/ioi11/contest/">IOI 2011, Race</a> (See <a class="rated-user user-violet" href="https://codeforces.com/profile/SaSaSaS" title="Candidate Master SaSaSaS">SaSaSaS</a>'s comment <a href="#comment-332425">below</a>).</p><p><a href="https://codeforces.com/contest/291/problem/E" title="Croc Champ 2013 - Qualification Round">291E - Tree-String Problem</a> : See <a class="rated-user user-blue" href="https://codeforces.com/profile/bhargav104" title="Expert bhargav104">bhargav104</a>'s comment <a href="#comment-316011">below</a>.</p><p><a href="https://codeforces.com/contest/1009/problem/F" title="Educational Codeforces Round 47 (Rated for Div. 2)">1009F - Dominant Indices</a> : <a href="https://codeforces.com/contest/1009/submission/40332812" title="Submission 40332812 by Arpa">40332812</a> Arpa-Style. Thanks to <a class="rated-user user-blue" href="https://codeforces.com/profile/baymaxx" title="Expert baymaxx">baymaxx</a>.</p><p><a href="https://codeforces.com/contest/343/problem/D" title="Codeforces Round 200 (Div. 1)">343D - Water Tree</a> : <a href="https://codeforces.com/contest/343/submission/15063078" title="Submission 15063078 by Arpa">15063078</a> Note that problem is not easy and my code doesn't use this technique (dsu on tree), but <a class="rated-user user-violet" href="https://codeforces.com/profile/AmirAz" title="Candidate Master AmirAz">AmirAz</a> 's solution to this problem uses this technique : <a href="https://codeforces.com/contest/343/submission/14904379" title="Submission 14904379 by AmirAz">14904379</a>.</p><p><a href="https://codeforces.com/contest/375/problem/D" title="Codeforces Round 221 (Div. 1)">375D - Tree and Queries</a> : <a href="https://codeforces.com/contest/375/submission/15449102" title="Submission 15449102 by Arpa">15449102</a> Again note that problem is not easy :)).</p><p><a href="https://codeforces.com/contest/716/problem/E" title="Codeforces Round 372 (Div. 2)">716E - Digit Tree</a> : <a href="https://codeforces.com/contest/716/submission/20776957">20776957</a> A hard problem. Also can be solved with centroid decomposition.</p><p><a href="https://codeforces.com/contest/741/problem/D" title="Codeforces Round 383 (Div. 1)">741D - Arpa’s letter-marked tree and Mehrdad’s Dokhtar-kosh paths</a> : <a href="https://codeforces.com/contest/741/submission/22796438" title="Submission 22796438 by Arpa">22796438</a> A hard problem. You must be very familiar with Dsu on tree to solve it.</p><p>For
 Persian users, there is another problem in Shaazzz contest round #4 
(season 2016-2017) problem 3 that is a very hard problem with this 
technique.</p><p>If you have another problem with this tag, give me to complete the list :)).</p><p>And after all, special thanks from <a class="rated-user user-red" href="https://codeforces.com/profile/amd" title="Grandmaster amd">amd</a> who taught me this technique.</p></div>
    </div>


        <div style="font-size: 1.1rem;line-height: 11px;">
            <img style="vertical-align: middle;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/tags.png" title="Tags" alt="Tags">
                <span style="padding: 0 0.35em;">
    <a href="https://codeforces.com/search?query=dsu+on+tree" class="tag notice" style="text-decoration: none;">dsu on tree</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="https://codeforces.com/search?query=sack" class="tag notice" style="text-decoration: none;">sack</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="https://codeforces.com/search?query=guni" class="tag notice" style="text-decoration: none;">guni</a>
                </span>
        </div>

    <div class="roundbox meta" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
        <div class="left-meta">
            <ul>
                    <li>        <a href="#" class="topic-vote-up-44511"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/voteup.png" alt="Vote: I like it" title="Vote: I like it"></a>
        &nbsp;


        <a href="#" class="topic-vote-up-44511">
        
        </a>
</li>
                    <li>

        
        <span title="Topic rating" style="font-size:larger;font-weight:bold;color:green">+68</span>
        
</li>
                    <li>        <a href="#" class="topic-vote-down-44511"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/votedown.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
        &nbsp;


        <a href="#" class="topic-vote-down-44511">
        
        </a>
</li>
            </ul>
        </div>

        <div class="yashare-auto-init" style="display: inline; position: relative; top: 5px; left: 0;" data-yasharel10n="en" data-yasharetype="none" data-yasharelink="https://codeforces.com/blog/entry/44351" data-yasharetitle="Codeforces: [Tutorial] Sack (dsu on tree)" data-yasharequickservices="vkontakte,facebook,twitter,lj"><span class="b-share"><a rel="nofollow" target="_blank" title="VKontakte" class="b-share__handle b-share__link b-share-btn__vkontakte" href="https://share.yandex.net/go.xml?service=vkontakte&amp;url=https%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="vkontakte"><span class="b-share-icon b-share-icon_vkontakte"></span></a><a rel="nofollow" target="_blank" title="Facebook" class="b-share__handle b-share__link b-share-btn__facebook" href="https://share.yandex.net/go.xml?service=facebook&amp;url=https%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="facebook"><span class="b-share-icon b-share-icon_facebook"></span></a><a rel="nofollow" target="_blank" title="Twitter" class="b-share__handle b-share__link b-share-btn__twitter" href="https://share.yandex.net/go.xml?service=twitter&amp;url=https%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="twitter"><span class="b-share-icon b-share-icon_twitter"></span></a><a rel="nofollow" target="_blank" title="LiveJournal" class="b-share__handle b-share__link b-share-btn__lj" href="https://share.yandex.net/go.xml?service=lj&amp;url=https%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="lj"><span class="b-share-icon b-share-icon_lj"></span></a></span></div>

        <span style="position: relative; top: 7px; left: 0.8em;">

    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="BLOG_ENTRY" data-entityid="44351" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

        </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="https://codeforces.com/profile/Arpa"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/user_16x16.png" alt="Author" title="Author"></a>
        &nbsp;


        <a href="https://codeforces.com/profile/Arpa">
        Arpa
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-0.2em;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/date_16x16.png" alt="Publication date" title="Publication date">
        &nbsp;


        
        <span class="format-humantime" title="Apr/14/2016 23:11 UTC+7">3 years ago</span>
        
</li>
                    <li>        <a href="https://codeforces.com/blog/entry/44351#comments"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comments_16x16.png" alt="Comments" title="Comments"></a>
        &nbsp;


        <a href="https://codeforces.com/blog/entry/44351#comments">
        124
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<div class="comments" commentableid="44528">
    <div class="title">
        <img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
        <a name="comments">Comments (124)</a>
    </div>
    <div><a href="#" class="new-root-comment" style="float:right;position:relative;bottom:3.25em;">Write comment?</a></div>

<div class="comment">
    <table class="comment-table" commentid="290526" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/maximaxi" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e50c1d977d6fb635.jpg">        </a>
        <div><a href="https://codeforces.com/profile/maximaxi" title="Specialist maximaxi" class="rated-user user-cyan">maximaxi</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 06:17 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290526" href="https://codeforces.com/blog/entry/44351?#comment-290526" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="290526" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290526" data-commentrating="4" data-commentuserid="257652">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+4</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290526">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://a2oj.com/category?ID=98">A2OJ's DSU Section</a> has quite a few tree DSU problems.</p><p>Thank you for this post, it explains the theory well and is very easy to read.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290526 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290526 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290526">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309660" commentparentid="290526">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gotosleep" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gotosleep" title="Specialist gotosleep" class="rated-user user-cyan">gotosleep</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/12/2016 05:57 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309660" href="https://codeforces.com/blog/entry/44351?#comment-309660" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290526" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="309660" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

    <script type="text/javascript">
        $(document).ready(function () {
            $("img.toggle-favourite").click(function () {
                var size = $(this).attr("data-size");
                var img = $(this);

                var isFavourite = !img.hasClass("remove-favourite");
                var type = img.attr("data-type");
                var entityId = img.attr("data-entityId");

                $.post("/data/favourite",
                        { entityId: entityId, type: type, isFavourite: isFavourite },
                        function(response) {
                            if (response["success"] != "true") {
                                alert(response["message"]);
                            } else {
                                if (img.hasClass("remove-favourite")) {
                                    img.attr("src", "//st.codeforces.com/s/12135/images/icons/star_gray_" + size + ".png");
                                    img.removeClass("remove-favourite");
                                    img.addClass("add-favourite");
                                } else {
                                    img.attr("src", "//st.codeforces.com/s/12135/images/icons/star_yellow_" + size + ".png");
                                    img.removeClass("add-favourite");
                                    img.addClass("remove-favourite");
                                }
                            }
                        }, "json"
                );

                return false;
            });
        });
    </script>
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309660" data-commentrating="-6" data-commentuserid="417511">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309660">
                    <div class="moveup">
                    <div class="ttypography"><p>بدك تضل تتمنيك عكل بوستات الخرا ؟</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309660 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309660 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309660">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="290623" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/n00gler" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/6d67324d2779fba2.jpg">        </a>
        <div><a href="https://codeforces.com/profile/n00gler" title="Candidate Master n00gler" class="rated-user user-violet">n00gler</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 08:19 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290623" href="https://codeforces.com/blog/entry/44351?#comment-290623" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="290623" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290623" data-commentrating="0" data-commentuserid="91604">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290623">
                    <div class="moveup">
                    <div class="ttypography"><p>What does the variable "keep" denote ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290623 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290623 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290623">
            <li>
<div class="comment">
    <table class="comment-table" commentid="290699" commentparentid="290623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/NibNalin" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/NibNalin" title="Expert NibNalin" class="rated-user user-blue">NibNalin</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 17:09 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290699" href="https://codeforces.com/blog/entry/44351?#comment-290699" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="290699" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="290699" revisioncount="4" revision="4">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="290699" data-commentrating="3" data-commentuserid="245756">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290699">
                    <div class="moveup">
                    <div class="ttypography"><p>The way I understand HLD
 here is basically if a child is the big child, we don't want to 
recompute answer for it to reduce computation. So we just store the 
answer for it in the <code class="tt">cnt</code> array already so that it's parent doesn't need to re-dfs this subtree. <code class="tt">keep</code> denotes whether or not this child is that big child. Please correct me if I'm wrong. :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290699 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290699 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290699">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="290707" commentparentid="290623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 17:44 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290707" href="https://codeforces.com/blog/entry/44351?#comment-290707" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="290707" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="290707" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="290707" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290707">
                    <div class="moveup">
                    <div class="ttypography"><p>Look at last two lines:</p> <pre><code class="prettyprint"><span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span></code></pre><p>It means that if <code class="tt">keep == false</code> after <code class="tt">dfs</code> clear <code class="tt">v</code>s subtree information from <code class="tt">cnt</code>. And if <code class="tt">keep == true</code>, don't clear <code class="tt">v</code>s subtree information from <code class="tt">cnt</code>. In other word if <code class="tt">keep == true</code>after calling <code class="tt">dfs</code>, for each <code class="tt">u</code> from subtree of vertice <code class="tt">v</code>, <code class="tt">col[u]</code> is in <code class="tt">cnt</code> (<code class="tt">cnt[ col[u] ]++</code>).</p><p>And <a class="rated-user user-cyan" href="https://codeforces.com/profile/NibNalin" title="Specialist NibNalin">NibNalin</a> is right. <code class="tt">keep</code> is <code class="tt">true</code> if and only if <code class="tt">v</code> is biggest child of it's parent.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290707 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290707 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290707">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309408" commentparentid="290707">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ka89" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ka89" title="Unrated, ka89" class="rated-user user-black">ka89</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/11/2016 05:49 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309408" href="https://codeforces.com/blog/entry/44351?#comment-309408" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290707" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="309408" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309408" data-commentrating="0" data-commentuserid="297381">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309408">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi Arpa, thanks a ton for this awesome post. I have really learnt lot from it.</p><p>I
 do have one question though. What is the advantage of having 
keep=false? If that part is kept as it is, without clearing, doesnt the 
computation become faster? Can you please help clearing this doubt?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309408 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309408 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309408">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309436" commentparentid="309408">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/11/2016 15:01 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309436" href="https://codeforces.com/blog/entry/44351?#comment-309436" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-309408" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="309436" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309436" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309436">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, Thanks.</p><p>Consider
 vertex v has two children, q and p. If you call dfs for both of them 
with keep = true, they will mixed up their information, and queries will
 be incorrectly answered.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309436 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309436 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309436">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309469" commentparentid="309436">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ka89" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ka89" title="Unrated, ka89" class="rated-user user-black">ka89</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/11/2016 21:41 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309469" href="https://codeforces.com/blog/entry/44351?#comment-309469" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-309436" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="309469" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309469" data-commentrating="0" data-commentuserid="297381">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309469">
                    <div class="moveup">
                    <div class="ttypography"><p>oh..ok. Got it now. Thanks.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309469 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309469 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309469">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="371768" commentparentid="309436">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Lance_HAOH" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/a699953466f2d6a.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Lance_HAOH" title="Pupil Lance_HAOH" class="rated-user user-green">Lance_HAOH</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/06/2017 03:24 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-371768" href="https://codeforces.com/blog/entry/44351?#comment-371768" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-309436" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="371768" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="371768" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="371768" data-commentrating="0" data-commentuserid="472788">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-371768">
                    <div class="moveup">
                    <div class="ttypography"><p>I guess this method is only viable if DP cannot be used? (i.e. Too many states to memoize)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-371768 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-371768 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-371768">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="290753" commentparentid="290623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/belakor" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/50496091ff0f2dff.jpg">        </a>
        <div><a href="https://codeforces.com/profile/belakor" title="Master belakor" class="rated-user user-orange">belakor</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 23:14 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290753" href="https://codeforces.com/blog/entry/44351?#comment-290753" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="290753" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290753" data-commentrating="34" data-commentuserid="229418">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+34</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290753">
                    <div class="moveup">
                    <div class="ttypography"><p>Observations to understand the complexity:</p> <ol>   <li>The <code class="tt">dfs</code> function visits each node exactly once.</li>   <li>The problem might seem with the add function. You might think that it is making the algorithm <code class="tt">n^2</code>. Note that in the <code class="tt">add</code> function, we only go down from a vertex to its children if the edge connecting the vertex to the child is a light edge.</li> </ol><p>You can think of it in this way, each vertex <code class="tt">v</code> will be visited by a call to the <code class="tt">add</code> function for any ancestor of <code class="tt">v</code> that is connected to a light edge. Since there are at most <code class="tt">log(n)</code> light edges going up from any vertex to the root, each vertex will be visited at most <code class="tt">log(n)</code> times.</p><p>So the algorithm is: Say you are at a vertex <code class="tt">v</code>, first you find the bigchild, then you run dfs on small childs, passing the value of keep as <code class="tt">0</code>. Why? So they are cleared from cnt. Then you run a dfs on bigchild, and you do not clear it from <code class="tt">cnt</code>. Now, <code class="tt">cnt</code> stores the results for all vertices in the subtree of <code class="tt">bigchild</code> (since we cleared <code class="tt">cnt</code> for small childs and didn't do so for the bigchild), so we call the <code class="tt">add</code>
 function to "add" the information of children of current vertex that 
are connected to it via a light edge. Now we are ready to compute the 
answer</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290753 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290753 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290753">
            <li>
<div class="comment">
    <table class="comment-table" commentid="370756" commentparentid="290753">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gogateiiit" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3a1d2285ca7fc2ce.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gogateiiit" title="Expert gogateiiit" class="rated-user user-blue">gogateiiit</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/01/2017 06:11 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-370756" href="https://codeforces.com/blog/entry/44351?#comment-370756" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290753" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="370756" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="370756" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="370756" data-commentrating="3" data-commentuserid="342197">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-370756">
                    <div class="moveup">
                    <div class="ttypography"><p>As you said "add" function goes down using only light edges,Don't these two lines <code class="tt">if(bigChild != -1)         big[bigChild] = 0;</code>
 of heavy light decomposition implementation would affect it as if you 
call "add" after all dfs are done and returned to the root then we only 
have one heavy edge marked that of root itself others are zero so as 
"add" goes below it traverses whole tree. Help me here.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-370756 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-370756 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-370756">
            <li>
<div class="comment">
    <table class="comment-table" commentid="370831" commentparentid="370756">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gogateiiit" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3a1d2285ca7fc2ce.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gogateiiit" title="Expert gogateiiit" class="rated-user user-blue">gogateiiit</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/01/2017 22:38 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-370831" href="https://codeforces.com/blog/entry/44351?#comment-370831" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-370756" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="370831" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="370831" data-commentrating="0" data-commentuserid="342197">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-370831">
                    <div class="moveup">
                    <div class="ttypography"><p>Got it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-370831 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-370831 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-370831">
            <li>
<div class="comment">
    <table class="comment-table" commentid="371371" commentparentid="370831">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gogateiiit" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3a1d2285ca7fc2ce.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gogateiiit" title="Expert gogateiiit" class="rated-user user-blue">gogateiiit</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/03/2017 17:47 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-371371" href="https://codeforces.com/blog/entry/44351?#comment-371371" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-370831" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="371371" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="371371" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="371371" data-commentrating="3" data-commentuserid="342197">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-371371">
                    <div class="moveup">
                    <div class="ttypography"><p>For those who had same 
doubt as I had: First lets understand why it is wrong to remove 
it,consider you are at particular node(let it be called A) in 
recursion,above line is not there,you have 3 children one of them is big
 child(3rd) while others are normal so you traversed inside 1st and came
 back to A then you traversed inside 2nd child if you do not have above 
line then while going inside this children you would have all answer for
 big children of 1st child which would mess your answer. Now let's 
understand why complexity is O(n(log(n)):</p><p>Note 1: To calculate complexity you need to measure how many times add function visits the ever y node.</p><p>Note
 2: For first add called at a node: A node will visited by add only 
through its ancestors which are connected by light edges so n nodes 
log(n) light edges above it this gives us O(n(log(n)))</p><p>Note 3: For
 second add called at a node: Now somebody may protest that that after 
above mentioned line(big[bigChild]=0) we are unmarking heavy edge and 
also calling add after that which may mess up complexity as it travels 
every node below it which is O(n) but keep==0 condition ensures that for
 each node there atmost log(n) nodes above in ancestor which have keep=0
 function is called.which again gives O(n(log(n)).</p><p>Giving us finally O(n(log(n))) complexity. Follow this link to understand heavy light decomposition's properties: <a href="https://blog.anudeep2011.com/heavy-light-decomposition/">https://blog.anudeep2011.com/heavy-light-decomposition/</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-371371 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-371371 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-371371">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="290906" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/the_art_of_war" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/33d0d7060aba26e0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/the_art_of_war" title="Candidate Master the_art_of_war" class="rated-user user-violet">the_art_of_war</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/27/2016 01:26 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290906" href="https://codeforces.com/blog/entry/44351?#comment-290906" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="290906" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290906" data-commentrating="0" data-commentuserid="281181">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290906">
                    <div class="moveup">
                    <div class="ttypography"><p>In second easy with O(n*lg n)</p><p>Why if(keep==false) we delete only vertex from main vector</p> <pre><code class="prettyprint"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]--;</span></code></pre><p>but we don't delete vertex from cnt which we changed here:</p> <pre><code class="prettyprint"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
       </span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290906 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290906 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290906">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293924" commentparentid="290906">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2016 17:08 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293924" href="https://codeforces.com/blog/entry/44351?#comment-293924" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290906" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="293924" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="293924" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="293924" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293924">
                    <div class="moveup">
                    <div class="ttypography"><p>There was a mistake in writing. I'm sorry.</p><p>Thanks for reporting this problem.</p><p>code should be:</p> <pre><code class="prettyprint"><span class="pln">       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
       </span><span class="pun">}</span></code></pre><p>Instead of:</p> <pre><code class="prettyprint"><span class="pln">       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
       </span><span class="pun">}</span></code></pre><p>I have edited that.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293924 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293924 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293924">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="293430" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/SProf" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/b62236ec5eade4cb.jpg">        </a>
        <div><a href="https://codeforces.com/profile/SProf" title="Newbie SProf" class="rated-user user-gray">SProf</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/12/2016 00:25 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293430" href="https://codeforces.com/blog/entry/44351?#comment-293430" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="293430" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293430" data-commentrating="0" data-commentuserid="343400">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293430">
                    <div class="moveup">
                    <div class="ttypography"><p>can someone tell me how 208E is solved with this technique? thanks a lot.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293430 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293430 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293430">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293772" commentparentid="293430">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/belakor" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/50496091ff0f2dff.jpg">        </a>
        <div><a href="https://codeforces.com/profile/belakor" title="Master belakor" class="rated-user user-orange">belakor</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/12/2016 21:33 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293772" href="https://codeforces.com/blog/entry/44351?#comment-293772" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293430" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="293772" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293772" data-commentrating="0" data-commentuserid="229418">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293772">
                    <div class="moveup">
                    <div class="ttypography"><p>You need to compute for each pair <code class="tt">v p</code> the p-th cousin of v. That is equivalent to finding the number of p-th descendants of the p-th ancestor of <code class="tt">v</code> — 1.</p><p>So for each query, replace <code class="tt">v p</code> with <code class="tt">p_th_ancestor_of_v p</code>. Now you need to store in <code class="tt">cnt</code> the number of nodes at a certain depth. In other words, <code class="tt">cnt[x]</code> should be equal to number of nodes at depth <code class="tt">x</code> in the current subtree.</p><p>Code for Reference: <a href="https://codeforces.com/contest/208/submission/17513471">http://codeforces.com/contest/208/submission/17513471</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293772 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293772 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293772">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293898" commentparentid="293772">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/shavidze" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/shavidze" title="Pupil shavidze" class="rated-user user-green">shavidze</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2016 08:10 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293898" href="https://codeforces.com/blog/entry/44351?#comment-293898" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293772" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="293898" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293898" data-commentrating="0" data-commentuserid="369978">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293898">
                    <div class="moveup">
                    <div class="ttypography"><p>can't understand why for
 every vertex v we ans[depth[v]] increase by 1 when we call add 
function,why must we do it?or why it must be ans[deth[v]] when depth[v] 
means distance from root to v? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293898 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293898 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293898">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293931" commentparentid="293898">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2016 17:57 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293931" href="https://codeforces.com/blog/entry/44351?#comment-293931" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293898" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="293931" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="293931" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="293931" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293931">
                    <div class="moveup">
                    <div class="ttypography"><p><code class="tt">ans[h]</code> is equal to number of vertices with height h, (with distance h from root).</p><p>Let par, p'th ancestor of v, the answer to query is:</p><p>Consider only subtree of vertice par, print ans[ height[v] ] — 1.</p><p>So with method above we can process all of the queries.</p><p>See my code for better understanding.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293931 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293931 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293931">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293949" commentparentid="293931">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/shavidze" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/shavidze" title="Pupil shavidze" class="rated-user user-green">shavidze</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2016 21:19 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293949" href="https://codeforces.com/blog/entry/44351?#comment-293949" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293931" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="293949" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293949" data-commentrating="5" data-commentuserid="369978">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293949">
                    <div class="moveup">
                    <div class="ttypography"><p>thanks everyone , now i understand.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293949 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293949 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293949">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="294284" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Sora233" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/fba4a8a3cf91ef1d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Sora233" title="Candidate Master Sora233" class="rated-user user-violet">Sora233</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/16/2016 18:38 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-294284" href="https://codeforces.com/blog/entry/44351?#comment-294284" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="294284" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="294284" data-commentrating="10" data-commentuserid="265481">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-294284">
                    <div class="moveup">
                    <div class="ttypography"><p>If i haven't read this article, i wouldn't get ac on <a href="https://codeforces.com/contest/570/problem/D">this</a> problem. It is another problem which can be solved easily by dsu. </p><p><a href="https://codeforces.com/contest/570/submission/17927999">here</a> is my code in HLD-style.</p><p>Thanks!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-294284 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-294284 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-294284">
            <li>
<div class="comment">
    <table class="comment-table" commentid="294479" commentparentid="294284">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/17/2016 06:49 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-294479" href="https://codeforces.com/blog/entry/44351?#comment-294479" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-294284" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="294479" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="294479" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-294479">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks! Added to list ;)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-294479 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-294479 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-294479">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="294295" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Batman" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/8a3ca30e0cd9c5b5.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Batman" title="Grandmaster Batman" class="rated-user user-red">Batman</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/16/2016 20:59 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-294295" href="https://codeforces.com/blog/entry/44351?#comment-294295" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="294295" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="294295" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="294295" data-commentrating="12" data-commentuserid="223127">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+12</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-294295">
                    <div class="moveup">
                    <div class="ttypography"><p>I can't understand why the second code is correct...</p><p>Consider this example:</p><p><img alt=" " src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3a156555cb73c2ee9d6a31f44f572bb8d57740f8.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>We wanna calculate the cnt for Vertex 8. These are the steps:</p><p>Going to Vertex 1</p><p>Going to Vertex 2 by keep=0</p><p>Going to Vertex 3 by keep=0,Vec[3]={3}</p><p>Going to Vertex 4 by keep=1,Vec[4]={4},Cnt[color[4]]=1</p><p>Going back to Vertex 2,Vec[2]={2,4},Cnt[color[4]]=0,Cnt[color[3]]=1</p><p>And then when we go to Vertices 5,6,7,8 still Cnt[color[3]]=1.</p><p>Also sorry if I did the steps wrong...</p><p><strong>UPD</strong> Thank you for editing the blog. My problem fixed.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-294295 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-294295 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-294295">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="304299" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gabrielsimoes" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gabrielsimoes" title="Expert gabrielsimoes" class="rated-user user-blue">gabrielsimoes</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/08/2016 11:13 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-304299" href="https://codeforces.com/blog/entry/44351?#comment-304299" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="304299" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="304299" revisioncount="4" revision="4">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="304299" data-commentrating="0" data-commentuserid="299517">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-304299">
                    <div class="moveup">
                    <div class="ttypography"><p>Great post. If you 
explained the idea before showing the code, it would be better to 
understand. Also commenting the variables meaning in the code would be 
of great help.</p><p>It would be good to mention that most solutions 
will answer the queries offline, which may be a problem sometime (maybe 
someone didn't notice this lol).</p><p>Also, it would be nice to post hints about the solutions.</p><p>Proving explicitly why it is <span class="tex-span"><i>nlogn</i></span> would be good too (ie. as each node's subtree set gets merged into one set of size equal or greater, and the base set has size <span class="tex-span">1</span> and the last set has size <span class="tex-span"><i>n</i></span>, then we take <span class="tex-span"><i>logn</i></span> steps to go from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. Summarizing, each node gets merged <span class="tex-span"><i>logn</i></span> times, so the total complexity is <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span>).</p><p>Here's my solution to 343D, maybe it will be of help to someone: <a href="https://codeforces.com/contest/343/submission/18958875">18958875</a>. A lot easier to code than the one in the tutorial.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-304299 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-304299 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-304299">
            <li>
<div class="comment">
    <table class="comment-table" commentid="308597" commentparentid="304299">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2016 13:51 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-308597" href="https://codeforces.com/blog/entry/44351?#comment-308597" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-304299" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="308597" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="308597" data-commentrating="2" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+2</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-308597">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for your suggestions first !</p><p>I proved that it is O(nlogn) : <em>You know that why dsu has O(q log n) time (for q queries); the code uses same method. Merge smaller to greater.</em></p><p>And about your code (<a href="https://codeforces.com/contest/343/submission/18958875" title="Submission 18958875 by gabrielsimoes">18958875</a>), anyone has a different opinion !</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-308597 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-308597 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-308597">
            <li>
<div class="comment">
    <table class="comment-table" commentid="308623" commentparentid="308597">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gabrielsimoes" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gabrielsimoes" title="Expert gabrielsimoes" class="rated-user user-blue">gabrielsimoes</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2016 21:17 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-308623" href="https://codeforces.com/blog/entry/44351?#comment-308623" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-308597" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="308623" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="308623" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="308623" data-commentrating="0" data-commentuserid="299517">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-308623">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for the reply!</p><p>Yeah,
 you did prove. People who remember DSU's proof will most likely 
understand. I stated a more extensive proof would be better thinking 
about people who don't exactly know the proof. Don't take me wrong, but 
they may get a little confused reading this proof.</p><p>I mentioned my code exactly because everyone has a different opinion,. Maybe it'll help a later reader, that's all.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-308623 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-308623 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-308623">
            <li>
<div class="comment">
    <table class="comment-table" commentid="316073" commentparentid="308623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/pivorics" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/69b5367428986c09.jpg">        </a>
        <div><a href="https://codeforces.com/profile/pivorics" title="Unrated, pivorics" class="rated-user user-black">pivorics</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/21/2016 02:32 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316073" href="https://codeforces.com/blog/entry/44351?#comment-316073" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-308623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="316073" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316073" data-commentrating="0" data-commentuserid="363194">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316073">
                    <div class="moveup">
                    <div class="ttypography"><p>Sorry this might be a stupid question to bring up, but why is the complexity of the heavy-light decomposition style one in <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span>?</p><p>In the case where each node has at most two children: Denote the root node of the tree as <span class="tex-span"><i>u</i></span>, which is of size <span class="tex-span"><i>s</i></span>. The child of <span class="tex-span"><i>u</i></span> connected to the lighter edge is of size at most <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/b496aff80f2a13c88d1f13ed172dd40658607029.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">. So the total number of nodes on which we run the "add" function would be at most <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/62e0b48e457b6451dd78792c4f64cb760a693ada.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">. So I don't understand where the <span class="tex-span"><i>log</i>(<i>n</i>)</span> factor comes from. </p><p>The
 online tutorial for HLD says a new chain is built when we arrive at a 
child node via a lighter edge, where each chain is stored as a segment 
tree, and so I can see there is indeed a <span class="tex-span"><i>O</i>(<i>logn</i>)</span> factor involved.</p><p>Regardless can you perhaps elaborate a little bit more on the time complexity of the dsu structure? Thank you!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316073 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316073 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316073">
            <li>
<div class="comment">
    <table class="comment-table" commentid="316139" commentparentid="316073">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/21/2016 20:10 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316139" href="https://codeforces.com/blog/entry/44351?#comment-316139" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316073" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="316139" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316139" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316139">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi !</p><p><em>The 
online tutorial for HLD says a new chain is built when we arrive at a 
child node via a lighter edge, where each chain is stored as a segment 
tree, and so I can see there is indeed a O(logn) factor involved.</em></p><p>As you know, if you use <code class="tt">segment tree</code> in <code class="tt">heavy-light decomposition</code>, each query time complexity will be <span class="tex-span"><i>O</i>(<i>log</i><sup class="upper-index">2</sup>(<i>n</i>))</span>. Because in each query you will go <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span> chains and in each chain it will spend <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span> time.</p><p>Now, I will proof that "heavy-light decomposition style implementation" of "dsu on tree" is <span class="tex-span"><i>O</i>(<i>n</i>.<i>log</i>(<i>n</i>))</span>:</p><p>Consider a complete binary tree with n vertices. In dfs function you will run another dfs function in child (<span class="tex-span"><i>T</i>(<i>n</i> / 2) * 2</span>) and you will call <code class="tt">add</code> function and it will spend <span class="tex-span"><i>O</i>(<i>n</i> / 2)</span> time. So, <span class="tex-span"><i>T</i>(<i>n</i>) = <i>n</i> / 2 + 2 * <i>T</i>(<i>n</i> / 2) = <i>O</i>(<i>n</i>.<i>log</i>(<i>n</i>))</span></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316139 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316139 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316139">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="335199" commentparentid="308597">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Emphi" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Emphi" title="Specialist Emphi" class="rated-user user-cyan">Emphi</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/03/2017 10:21 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-335199" href="https://codeforces.com/blog/entry/44351?#comment-335199" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-308597" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="335199" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="335199" data-commentrating="0" data-commentuserid="387480">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-335199">
                    <div class="moveup">
                    <div class="ttypography"><blockquote>   <blockquote><p>You know that why dsu has O(q log n) time (for q queries); the code uses same method. Merge smaller to greater.</p>   </blockquote> </blockquote><p>Pardon me , but I don't follow. Which dsu are you talking about? The one with inverse-Ackermann function?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-335199 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-335199 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-335199">
            <li>
<div class="comment">
    <table class="comment-table" commentid="335249" commentparentid="335199">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/03/2017 21:03 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-335249" href="https://codeforces.com/blog/entry/44351?#comment-335249" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-335199" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="335249" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="335249" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-335249">
                    <div class="moveup">
                    <div class="ttypography"><p>No. Dsu with size compare. Like this : </p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> find</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> par</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">par</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> merge</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">){</span><span class="pln">
    v </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">v</span><span class="pun">),</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v </span><span class="pun">==</span><span class="pln"> u</span><span class="pun">)</span><span class="pln">  </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">size</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">  swap</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">);</span><span class="pln">
    par</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    size</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> size</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-335249 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-335249 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-335249">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="312836" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/rcg_" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/rcg_" title="Candidate Master rcg_" class="rated-user user-violet">rcg_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/30/2016 05:38 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-312836" href="https://codeforces.com/blog/entry/44351?#comment-312836" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="312836" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="312836" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="312836" data-commentrating="0" data-commentuserid="350715">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-312836">
                    <div class="moveup">
                    <div class="ttypography"><p>In easy to code but 
O(nlog^ 2), I cant't understand why do we store the size of subtrees of 
vertices in array sz and use it as the criteria for choosing the big 
child, I think we should store in the array "sz" the number of distinct 
colors in the subtree of any node v, because that is what we actually 
iterate on when transferring the map from v to u, why is this wrong?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-312836 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-312836 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-312836">
            <li>
<div class="comment">
    <table class="comment-table" commentid="312897" commentparentid="312836">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/30/2016 16:22 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-312897" href="https://codeforces.com/blog/entry/44351?#comment-312897" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-312836" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="312897" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="312897" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-312897">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi !</p><p>It isn't wrong! Both of your method and mine have the same worst case. But your average is better.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-312897 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-312897 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-312897">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="499558" commentparentid="312897">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Chhatarpur" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/10fdb94236c7f8e2.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Chhatarpur" title="Expert Chhatarpur" class="rated-user user-blue">Chhatarpur</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Mar/17/2019 05:37 UTC+7">6 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-499558" href="https://codeforces.com/blog/entry/44351?#comment-499558" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-312897" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="499558" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="499558" data-commentrating="0" data-commentuserid="567635">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-499558">
                    <div class="moveup">
                    <div class="ttypography"><p>Is child's subtree-size working as a heuristic for the number-of-distinct-colors in that child? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-499558 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-499558 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-499558">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="312855" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/algo.experiments" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/algo.experiments" title="Candidate Master algo.experiments" class="rated-user user-violet">algo.experiments</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/30/2016 08:16 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-312855" href="https://codeforces.com/blog/entry/44351?#comment-312855" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="312855" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="312855" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="312855" data-commentrating="0" data-commentuserid="407163">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-312855">
                    <div class="moveup">
                    <div class="ttypography"><p>Ahh, thanks 
gabrielsimoes, for anyone struggling to understand: n*log^2n is about 
answering queries OFFLINE right during the dfs. After the dfs has 
finished the cnt[v] will no longer be a valid map for vertices that were
 chosen as bigChild.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-312855 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-312855 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-312855">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="316011" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bhargav104" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/2697e92750c0dd9.jpg">        </a>
        <div><a href="https://codeforces.com/profile/bhargav104" title="Expert bhargav104" class="rated-user user-blue">bhargav104</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/20/2016 04:47 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316011" href="https://codeforces.com/blog/entry/44351?#comment-316011" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="316011" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316011" data-commentrating="8" data-commentuserid="246134">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316011">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://codeforces.com/problemset/problem/291/E">http://codeforces.com/problemset/problem/291/E</a> <a href="https://codeforces.com/contest/291/problem/E" title="Croc Champ 2013 - Qualification Round">291E - Tree-String Problem</a> <a class="rated-user user-violet" href="https://codeforces.com/profile/Arpa" title="Candidate Master Arpa">Arpa</a>
 This problem can also be done by dsu on trees. Calculate hash value for
 each suffix value of target string. Then for each suffix of an edge if 
it is a valid prefix of the target string we would just need the 
frequency of the hash value of the remaining suffix of the target string
 in its subtree which can be maintained by this technique. The case when
 the entire string occurs in an edge can be dealt with separately.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316011 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316011 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316011">
            <li>
<div class="comment">
    <table class="comment-table" commentid="316047" commentparentid="316011">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/20/2016 22:26 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316047" href="https://codeforces.com/blog/entry/44351?#comment-316047" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316011" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="316047" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316047" data-commentrating="5" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316047">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks added to list, but it can be solved very easier : <a href="https://codeforces.com/contest/291/submission/19827525" title="Submission 19827525 by Arpa">19827525</a>, just use KMP.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316047 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316047 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316047">
            <li>
<div class="comment">
    <table class="comment-table" commentid="378467" commentparentid="316047">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Dalgerok" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/c7877fa622851629.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Dalgerok" title="Candidate Master Dalgerok" class="rated-user user-violet">Dalgerok</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/13/2017 22:04 UTC+7">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-378467" href="https://codeforces.com/blog/entry/44351?#comment-378467" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316047" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="378467" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="378467" data-commentrating="0" data-commentuserid="483933">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-378467">
                    <div class="moveup">
                    <div class="ttypography"><p>Just use hashes :) <a href="https://codeforces.com/contest/291/submission/29431526">http://codeforces.com/contest/291/submission/29431526</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-378467 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-378467 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-378467">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="423599" commentparentid="316011">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bktl1love" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/fc6a2047fd5bd4c8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/bktl1love" title="Candidate Master bktl1love" class="rated-user user-violet">bktl1love</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/06/2018 00:58 UTC+7">13 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-423599" href="https://codeforces.com/blog/entry/44351?#comment-423599" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316011" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="423599" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="423599" data-commentrating="0" data-commentuserid="415658">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-423599">
                    <div class="moveup">
                    <div class="ttypography"><p>Please send me a code of the solution with this techinque)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-423599 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-423599 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-423599">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="329434" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sengxian" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sengxian" title="Candidate Master sengxian" class="rated-user user-violet">sengxian</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/07/2016 14:27 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329434" href="https://codeforces.com/blog/entry/44351?#comment-329434" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="329434" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="329434" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="329434" data-commentrating="13" data-commentuserid="338917">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329434">
                    <div class="moveup">
                    <div class="ttypography"><p>Actually, in China, we 
call this method as "Heuristic Merge" which always merge the smaller to 
the bigger. Not hard to understand each vertex will be visited in O(log 
n) times because when we visited a vertex, then the size of tree which 
the vertex is in doubled.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329434 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329434 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329434">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="329879" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhigarg1796" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhigarg1796" title="Specialist abhigarg1796" class="rated-user user-cyan">abhigarg1796</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/10/2016 03:17 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329879" href="https://codeforces.com/blog/entry/44351?#comment-329879" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="329879" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329879" data-commentrating="1" data-commentuserid="417191">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329879">
                    <div class="moveup">
                    <div class="ttypography"><p>Hey Arpa,</p><p>In your 
my invented style I'm unable to understand that why in third loop are 
you not checking for u not being parent of v. Why are you only checking 
for just u not being the big child.</p><p>Thanks in Advance</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329879 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329879 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329879">
            <li>
<div class="comment">
    <table class="comment-table" commentid="329880" commentparentid="329879">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/10/2016 03:20 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329880" href="https://codeforces.com/blog/entry/44351?#comment-329880" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-329879" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="329880" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329880" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329880">
                    <div class="moveup">
                    <div class="ttypography"><p>Sorry, fixed. It's because I've copied my code from <a href="https://codeforces.com/contest/741/problem/D" title="Codeforces Round 383 (Div. 1)">741D - Arpa’s letter-marked tree and Mehrdad’s Dokhtar-kosh paths</a>, input for this problem was a rooted tree.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329880 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329880 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329880">
            <li>
<div class="comment">
    <table class="comment-table" commentid="329882" commentparentid="329880">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhigarg1796" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhigarg1796" title="Specialist abhigarg1796" class="rated-user user-cyan">abhigarg1796</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/10/2016 03:59 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329882" href="https://codeforces.com/blog/entry/44351?#comment-329882" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-329880" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="329882" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329882" data-commentrating="2" data-commentuserid="417191">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+2</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329882">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks a lot,</p><p>Also, I think there is one more mistake. You never added col[v] to the array. Am I missing something. Thanks in advance.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329882 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329882 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329882">
            <li>
<div class="comment">
    <table class="comment-table" commentid="329889" commentparentid="329882">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/10/2016 04:45 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329889" href="https://codeforces.com/blog/entry/44351?#comment-329889" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-329882" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="329889" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329889" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329889">
                    <div class="moveup">
                    <div class="ttypography"><p>You are right, I'm very thankful to you. I was careless while coping the code from polygon.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329889 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329889 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329889">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="332417" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bhishma" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3d9acda8e0c1d8a2.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/bhishma" title="Expert bhishma" class="rated-user user-blue">bhishma</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 21:40 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332417" href="https://codeforces.com/blog/entry/44351?#comment-332417" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332417" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332417" data-commentrating="0" data-commentuserid="305276">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332417">
                    <div class="moveup">
                    <div class="ttypography"><p>In the easy to code <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span> method <code class="tt">vec[v]</code>
 stores all the vertices in the the subtree rooted at v . How will this 
fit into memory if we are not deleting the vec of child after merging it
 with the parent</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332417 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332417 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332417">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332420" commentparentid="332417">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 22:07 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332420" href="https://codeforces.com/blog/entry/44351?#comment-332420" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332417" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332420" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332420" data-commentrating="1" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332420">
                    <div class="moveup">
                    <div class="ttypography"><p>Used memory is always less than or equal to time complexity, so when time complexity is <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/670ed5e279d3e4a1f2f6aa6f9791e74d91b527ef.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">, used memory is less than or equal to <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/670ed5e279d3e4a1f2f6aa6f9791e74d91b527ef.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">. In this case, used memory is <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/670ed5e279d3e4a1f2f6aa6f9791e74d91b527ef.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">. Although if you delete useless <span class="tex-span"><i>vec</i></span>'s the memory become <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/d149e37848c7f7e231f2f79fcfe74bfa4ddab02a.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332420 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332420 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332420">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332421" commentparentid="332420">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bhishma" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3d9acda8e0c1d8a2.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/bhishma" title="Expert bhishma" class="rated-user user-blue">bhishma</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 22:09 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332421" href="https://codeforces.com/blog/entry/44351?#comment-332421" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332420" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332421" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332421" data-commentrating="0" data-commentuserid="305276">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332421">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for the reply . I think this problem can also be solved using your approach. <a href="https://www.hackerearth.com/practice/algorithms/graphs/depth-first-search/practice-problems/algorithm/the-grass-type/">(The Grass Type HackerEarth)</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332421 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332421 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332421">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332422" commentparentid="332421">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 22:13 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332422" href="https://codeforces.com/blog/entry/44351?#comment-332422" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332421" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332422" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="332422" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="332422" data-commentrating="1" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332422">
                    <div class="moveup">
                    <div class="ttypography"><p>I'll add this problem to the post if I find it related, I'm thankful anyway.</p><p><strong>Edit</strong> : Note that this is not <strong>my</strong>
 approach, but I'm the first man who publishes a tutorial about this 
(not sure), Sack has been used in INOI, IOI and ACM several times, so it
 isn't a new thing, invented be me.</p><p><strong>Edit</strong> : Added.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332422 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332422 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332422">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332425" commentparentid="332422">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/SaYami" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cc959eadd8b2c093.jpg">        </a>
        <div><a href="https://codeforces.com/profile/SaYami" title="Expert SaYami" class="rated-user user-blue">SaYami</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 22:53 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332425" href="https://codeforces.com/blog/entry/44351?#comment-332425" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332422" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332425" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332425" data-commentrating="0" data-commentuserid="370431">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332425">
                    <div class="moveup">
                    <div class="ttypography"><p>Can you mention probelms from the IOI that are solved with sack ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332425 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332425 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332425">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332426" commentparentid="332425">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 22:55 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332426" href="https://codeforces.com/blog/entry/44351?#comment-332426" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332425" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332426" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="332426" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="332426" data-commentrating="6" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332426">
                    <div class="moveup">
                    <div class="ttypography"><p>I'll add one of them tonight.</p><p><strong>Edit</strong> : Added.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332426 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332426 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332426">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332514" commentparentid="332426">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/SaYami" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cc959eadd8b2c093.jpg">        </a>
        <div><a href="https://codeforces.com/profile/SaYami" title="Expert SaYami" class="rated-user user-blue">SaYami</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 20:20 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332514" href="https://codeforces.com/blog/entry/44351?#comment-332514" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332426" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332514" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332514" data-commentrating="0" data-commentuserid="370431">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332514">
                    <div class="moveup">
                    <div class="ttypography"><p>Wow, I didn't think of solving it with sack.Thx</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332514 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332514 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332514">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="333721" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Agassaa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Agassaa" title="Pupil Agassaa" class="rated-user user-green">Agassaa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/29/2016 05:34 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-333721" href="https://codeforces.com/blog/entry/44351?#comment-333721" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="333721" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="333721" data-commentrating="0" data-commentuserid="355039">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-333721">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi <a class="rated-user user-violet" href="https://codeforces.com/profile/Arpa" title="Candidate Master Arpa">Arpa</a>, I can not understand, why is this approach called <strong>dsu</strong>
 on tree? This approach has a nice trick to reduce complexity by saving 
data about "big child". I can't see any special similarity with general 
dsu approach. In general dsu problems, we merge 2 subset into 1 set by 
linked list approach. But, in your tutorial there is no "merge" 
function. Am I missing something? </p><p>Also I see that, in your 600E's solution <a href="https://codeforces.com/contest/600/submission/14554536" title="Submission 14554536 by Arpa">14554536</a> you used merge functon. I can't understand, could you please explain that code?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-333721 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-333721 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-333721">
            <li>
<div class="comment">
    <table class="comment-table" commentid="333954" commentparentid="333721">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/30/2016 02:09 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-333954" href="https://codeforces.com/blog/entry/44351?#comment-333954" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-333721" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="333954" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="333954" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-333954">
                    <div class="moveup">
                    <div class="ttypography"><p>In fact we are merging information of small children with big child. Think more.</p><p>In that code, <span class="tex-span"><i>mrg</i></span> function merges information in <span class="tex-span"><i>u</i></span> into <span class="tex-span"><i>v</i></span>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-333954 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-333954 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-333954">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="334003" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/beAwesome" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/c862a42501f3a088.jpg">        </a>
        <div><a href="https://codeforces.com/profile/beAwesome" title="Specialist beAwesome" class="rated-user user-cyan">beAwesome</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/30/2016 04:27 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334003" href="https://codeforces.com/blog/entry/44351?#comment-334003" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="334003" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334003" data-commentrating="1" data-commentuserid="231693">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334003">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi <a class="rated-user user-violet" href="https://codeforces.com/profile/Arpa" title="Candidate Master Arpa">Arpa</a>! Thanks for making this tutorial.</p><p>I
 just want to make sure my understanding is correct: this merging 
smaller maps into larger ones takes logarithmic time because when a 
vertex is merged, the new map it is in at least twice its size. Hence, 
merging can only happen <span class="tex-span"><i>log</i>(<i>n</i>)</span> times for each of the <span class="tex-span"><i>n</i></span> vertices, leading to a total runtime of <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span>?</p><p>Thanks!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334003 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334003 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334003">
            <li>
<div class="comment">
    <table class="comment-table" commentid="334005" commentparentid="334003">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/30/2016 04:30 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334005" href="https://codeforces.com/blog/entry/44351?#comment-334005" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-334003" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="334005" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334005" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334005">
                    <div class="moveup">
                    <div class="ttypography"><p>Yes, but note that if you use map, it's <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/20da09178d7e4cd7a5aae9ab05892f920b6eb200.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334005 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334005 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334005">
            <li>
<div class="comment">
    <table class="comment-table" commentid="334006" commentparentid="334005">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/beAwesome" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/c862a42501f3a088.jpg">        </a>
        <div><a href="https://codeforces.com/profile/beAwesome" title="Specialist beAwesome" class="rated-user user-cyan">beAwesome</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/30/2016 04:34 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334006" href="https://codeforces.com/blog/entry/44351?#comment-334006" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-334005" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="334006" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334006" data-commentrating="0" data-commentuserid="231693">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334006">
                    <div class="moveup">
                    <div class="ttypography"><p>If you use unordered_map, does it become <span class="tex-span"><i>O</i>(<i>n</i>·<i>logn</i>)</span>, then?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334006 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334006 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334006">
            <li>
<div class="comment">
    <table class="comment-table" commentid="334020" commentparentid="334006">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/30/2016 06:03 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334020" href="https://codeforces.com/blog/entry/44351?#comment-334020" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-334006" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="334020" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334020" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334020">
                    <div class="moveup">
                    <div class="ttypography"><p>Unordered_map is theoretically <span class="tex-span"><i>O</i>(<i>n</i>)</span> per query. But you can suppose that it's O(1) per query in code.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334020 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334020 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334020">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="339408" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/surajghosh" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/surajghosh" title="Pupil surajghosh" class="rated-user user-green">surajghosh</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/24/2017 17:36 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-339408" href="https://codeforces.com/blog/entry/44351?#comment-339408" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="339408" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="339408" data-commentrating="0" data-commentuserid="315023">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-339408">
                    <div class="moveup">
                    <div class="ttypography"><p>This <a href="https://codeforces.com/contest/758/problem/E">758E</a>.Read <a href="https://codeforces.com/blog/entry/49880?#comment-338657">this</a> comment on how to use it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-339408 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-339408 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-339408">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="348567" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/HUECTRUM1" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/1a05429262bfd712.jpg">        </a>
        <div><a href="https://codeforces.com/profile/HUECTRUM1" title="Expert HUECTRUM1" class="rated-user user-blue">HUECTRUM1</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/13/2017 14:23 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-348567" href="https://codeforces.com/blog/entry/44351?#comment-348567" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="348567" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="348567" data-commentrating="0" data-commentuserid="512204">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-348567">
                    <div class="moveup">
                    <div class="ttypography"><p>Why do we need to iterate through the children of v after <code class="tt">add(v,p,-1)</code>in the naive approach? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-348567 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-348567 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-348567">
            <li>
<div class="comment">
    <table class="comment-table" commentid="348571" commentparentid="348567">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/satyaki3794" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/b1a19567ff40a815.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/satyaki3794" title="International master satyaki3794" class="rated-user user-orange">satyaki3794</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/13/2017 15:54 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-348571" href="https://codeforces.com/blog/entry/44351?#comment-348571" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-348567" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="348571" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="348571" data-commentrating="0" data-commentuserid="229270">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-348571">
                    <div class="moveup">
                    <div class="ttypography"><p>dfs() solves the problem
 for all the nodes, not just one. So, after you've gotten the answer for
 v, it will calculate the answer for its children.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-348571 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-348571 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-348571">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="350281" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/vatsal" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/501c4de31c9b6916.jpg">        </a>
        <div><a href="https://codeforces.com/profile/vatsal" title="Pupil vatsal" class="rated-user user-green">vatsal</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/22/2017 21:43 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350281" href="https://codeforces.com/blog/entry/44351?#comment-350281" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350281" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350281" data-commentrating="8" data-commentuserid="317733">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-350281">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://www.hackerrank.com/contests/101hack47/challenges/summing-in-a-tree">101 Hack 47 Summing Tree</a> was solved using this technique by <a class="rated-user user-violet" href="https://codeforces.com/profile/satyaki3794" title="Candidate Master satyaki3794">satyaki3794</a> <a href="https://www.hackerrank.com/contests/101hack47/challenges/summing-in-a-tree/submissions/code/1301038152">Submission</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350281 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350281 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350281">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="350329" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/lukecavabarrett" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/lukecavabarrett" title="Expert lukecavabarrett" class="rated-user user-blue">lukecavabarrett</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/23/2017 04:49 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350329" href="https://codeforces.com/blog/entry/44351?#comment-350329" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350329" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350329" data-commentrating="3" data-commentuserid="464823">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-350329">
                    <div class="moveup">
                    <div class="ttypography"><p>also <a href="https://codeforces.com/contest/778/problem/C" title="Codeforces Round 402 (Div. 1)">778C - Peterson Polyglot</a> is solvable with a similar tecnique: is that DSU on tree?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350329 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350329 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350329">
            <li>
<div class="comment">
    <table class="comment-table" commentid="350330" commentparentid="350329">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/radoslav11" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/31892ad68176342b.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/radoslav11" title="Grandmaster radoslav11" class="rated-user user-red">radoslav11</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/23/2017 04:51 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350330" href="https://codeforces.com/blog/entry/44351?#comment-350330" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-350329" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350330" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350330" data-commentrating="3" data-commentuserid="201686">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-350330">
                    <div class="moveup">
                    <div class="ttypography"><p>yes</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350330 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350330 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350330">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="364138" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/__W__" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cb6293da044bef20.jpg">        </a>
        <div><a href="https://codeforces.com/profile/__W__" title="Master __W__" class="rated-user user-orange">__W__</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/04/2017 01:31 UTC+7">23 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364138" href="https://codeforces.com/blog/entry/44351?#comment-364138" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="364138" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364138" data-commentrating="6" data-commentuserid="456151">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364138">
                    <div class="moveup">
                    <div class="ttypography"><p>Can anyone give me a link to "Shaazzz contest round #4 (season 2016-2017) problem 3" or tell me where can I find it? Thanks.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364138 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364138 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364138">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364139" commentparentid="364138">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/04/2017 01:32 UTC+7">23 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364139" href="https://codeforces.com/blog/entry/44351?#comment-364139" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364138" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="364139" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364139" data-commentrating="5" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364139">
                    <div class="moveup">
                    <div class="ttypography"><p>It's a Persian contest.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364139 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364139 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364139">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364140" commentparentid="364139">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/__W__" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cb6293da044bef20.jpg">        </a>
        <div><a href="https://codeforces.com/profile/__W__" title="Master __W__" class="rated-user user-orange">__W__</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/04/2017 01:40 UTC+7">23 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364140" href="https://codeforces.com/blog/entry/44351?#comment-364140" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364139" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="364140" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364140" data-commentrating="6" data-commentuserid="456151">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364140">
                    <div class="moveup">
                    <div class="ttypography"><p>Can you tell me where can I find it? I searched for it just now but didn't get it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364140 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364140 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364140">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364141" commentparentid="364140">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/04/2017 01:42 UTC+7">23 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364141" href="https://codeforces.com/blog/entry/44351?#comment-364141" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364140" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="364141" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364141" data-commentrating="6" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364141">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="http://bayanbox.ir/download/1100498381793313195/shaazzz4.7z">Link</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364141 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364141 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364141">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364142" commentparentid="364141">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/__W__" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cb6293da044bef20.jpg">        </a>
        <div><a href="https://codeforces.com/profile/__W__" title="Master __W__" class="rated-user user-orange">__W__</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/04/2017 01:44 UTC+7">23 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364142" href="https://codeforces.com/blog/entry/44351?#comment-364142" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364141" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="364142" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364142" data-commentrating="11" data-commentuserid="456151">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+11</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364142">
                    <div class="moveup">
                    <div class="ttypography"><p>Thank you!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364142 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364142 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364142">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="366361" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/tak_fate" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/93038af361d69183.jpg">        </a>
        <div><a href="https://codeforces.com/profile/tak_fate" title="Specialist tak_fate" class="rated-user user-cyan">tak_fate</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/13/2017 05:11 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-366361" href="https://codeforces.com/blog/entry/44351?#comment-366361" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="366361" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="366361" data-commentrating="0" data-commentuserid="418180">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-366361">
                    <div class="moveup">
                    <div class="ttypography"><p>I can AC easily Problem 375D by the 3th way ,but WA by the 4th way.... WA on the test 4.. why..</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-366361 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-366361 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-366361">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="370871" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gabrielsimoes" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gabrielsimoes" title="Expert gabrielsimoes" class="rated-user user-blue">gabrielsimoes</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/02/2017 01:09 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-370871" href="https://codeforces.com/blog/entry/44351?#comment-370871" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="370871" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="370871" data-commentrating="0" data-commentuserid="299517">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-370871">
                    <div class="moveup">
                    <div class="ttypography"><p>APIO 2016 Fireworks uses this, but is a much harder problem.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-370871 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-370871 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-370871">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="377346" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/maxorand" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/maxorand" title="Specialist maxorand" class="rated-user user-cyan">maxorand</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2017 19:29 UTC+7">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-377346" href="https://codeforces.com/blog/entry/44351?#comment-377346" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="377346" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="377346" data-commentrating="0" data-commentuserid="588224">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-377346">
                    <div class="moveup">
                    <div class="ttypography"><p><a class="rated-user user-violet" href="https://codeforces.com/profile/Arpa" title="Candidate Master Arpa">Arpa</a>, in the <strong>Easy to code but <span class="tex-span"><i>O</i>(<i>nlog</i><sup class="upper-index">2</sup><i>n</i>)</span></strong> section code you have written a commented line that is : <code class="tt">//now (*cnt)[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</code>. But I think it would be <code class="tt">//now (*cnt[v])[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</code>. Will <code class="tt">(*cnt)[c]</code> changed with <code class="tt">(*cnt[v])[c]</code> ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-377346 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-377346 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-377346">
            <li>
<div class="comment">
    <table class="comment-table" commentid="377351" commentparentid="377346">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2017 20:59 UTC+7">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-377351" href="https://codeforces.com/blog/entry/44351?#comment-377351" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-377346" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="377351" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="377351" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-377351">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi. Thanks. Edited.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-377351 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-377351 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-377351">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="382293" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Trath" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/d6806c6ddd9f10ab.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Trath" title="Specialist Trath" class="rated-user user-cyan">Trath</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/30/2017 13:10 UTC+7">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-382293" href="https://codeforces.com/blog/entry/44351?#comment-382293" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="382293" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="382293" data-commentrating="0" data-commentuserid="471966">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-382293">
                    <div class="moveup">
                    <div class="ttypography"><p>You can solve <a href="https://dmoj.ca/problem/apio12p1">APIO 2012 Dispatching</a> with this technique too.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-382293 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-382293 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-382293">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="392942" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/mochow" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/bd3960384748e28.jpg">        </a>
        <div><a href="https://codeforces.com/profile/mochow" title="Specialist mochow" class="rated-user user-cyan">mochow</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/31/2017 03:28 UTC+7">18 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-392942" href="https://codeforces.com/blog/entry/44351?#comment-392942" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="392942" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="392942" data-commentrating="0" data-commentuserid="93201">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-392942">
                    <div class="moveup">
                    <div class="ttypography"><p>IOI 2011 — Race What is the idea of DSU on tree for this problem? I know of a solution based on Centroid Decomposition.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-392942 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-392942 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-392942">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="408987" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Zeus726" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/ed3b38bfa4d53e2b.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Zeus726" title="Expert Zeus726" class="rated-user user-blue">Zeus726</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/21/2018 19:48 UTC+7">15 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-408987" href="https://codeforces.com/blog/entry/44351?#comment-408987" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="408987" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="408987" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="408987" data-commentrating="8" data-commentuserid="595640">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-408987">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://codeforces.com/contest/914/problem/E">914E - Palindromes in a Tree</a> can solve with sack too, Arpa :) </p><p>ps: for this problem centroid decompose works too... :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-408987 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-408987 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-408987">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="414426" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/pk842" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/pk842" title="Expert pk842" class="rated-user user-blue">pk842</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/16/2018 04:52 UTC+7">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-414426" href="https://codeforces.com/blog/entry/44351?#comment-414426" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="414426" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="414426" data-commentrating="0" data-commentuserid="622451">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-414426">
                    <div class="moveup">
                    <div class="ttypography"><p>can anyone please explain how to solve 716E using this technique?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-414426 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-414426 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-414426">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="416220" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/shahidul_brur" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/4dadb4adff8ea776.jpg">        </a>
        <div><a href="https://codeforces.com/profile/shahidul_brur" title="Expert shahidul_brur" class="rated-user user-blue">shahidul_brur</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/22/2018 18:35 UTC+7">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-416220" href="https://codeforces.com/blog/entry/44351?#comment-416220" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="416220" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="416220" data-commentrating="5" data-commentuserid="334688">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-416220">
                    <div class="moveup">
                    <div class="ttypography"><p>In the contest 600, no one can view other's submissions except his own.</p><p>That's why no can see your submissions for <a href="https://codeforces.com/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a> except you.</p><p>So, please give alternating link of your solutions for the first problem in the list, <a href="https://codeforces.com/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-416220 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-416220 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-416220">
            <li>
<div class="comment">
    <table class="comment-table" commentid="416234" commentparentid="416220">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/22/2018 21:27 UTC+7">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-416234" href="https://codeforces.com/blog/entry/44351?#comment-416234" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-416220" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="416234" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="416234" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-416234">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi.</p><p>Thanks for your feedback. Here it is: <a href="https://gist.github.com/ar-pa/efc71c4ea8ede3e56eeea40f9465496e">Link</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-416234 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-416234 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-416234">
            <li>
<div class="comment">
    <table class="comment-table" commentid="416235" commentparentid="416234">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/shahidul_brur" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/4dadb4adff8ea776.jpg">        </a>
        <div><a href="https://codeforces.com/profile/shahidul_brur" title="Expert shahidul_brur" class="rated-user user-blue">shahidul_brur</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/22/2018 21:30 UTC+7">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-416235" href="https://codeforces.com/blog/entry/44351?#comment-416235" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-416234" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="416235" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="416235" data-commentrating="0" data-commentuserid="334688">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-416235">
                    <div class="moveup">
                    <div class="ttypography"><p>Thank you !</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-416235 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-416235 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-416235">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="417852" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Vicennial" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/1710742b12e148ec.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Vicennial" title="Candidate Master Vicennial" class="rated-user user-violet">Vicennial</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/03/2018 01:21 UTC+7">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-417852" href="https://codeforces.com/blog/entry/44351?#comment-417852" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="417852" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="417852" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="417852" data-commentrating="0" data-commentuserid="447187">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-417852">
                    <div class="moveup">
                    <div class="ttypography"><p>Another problem which can be solved by this technique: <a href="https://www.hackerrank.com/challenges/coloring-tree/problem">Coloring Tree</a><br>Its easier than <a href="https://codeforces.com/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a>. </p><p>One more : <a href="https://codeforces.com/contest/932/problem/F">932F - Escape Through Leaf</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-417852 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-417852 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-417852">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="419614" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/lzoi_hhn" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/lzoi_hhn" title="Pupil lzoi_hhn" class="rated-user user-green">lzoi_hhn</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/11/2018 01:52 UTC+7">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-419614" href="https://codeforces.com/blog/entry/44351?#comment-419614" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="419614" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="419614" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="419614" data-commentrating="0" data-commentuserid="692530">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-419614">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, I would like to ask 
you about the code in heavy-light decomposition style.Why the bigChild 
is cleared before clearing the subtree at the end of the code? From my 
perspective, in add function bigChild will be visited and the array 
“big” doesn’t make sense.Can you explain it in detail? Thanks a lot.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-419614 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-419614 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-419614">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="420968" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kirito_" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/kirito_" title="Specialist kirito_" class="rated-user user-cyan">kirito_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/19/2018 22:43 UTC+7">13 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-420968" href="https://codeforces.com/blog/entry/44351?#comment-420968" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="420968" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="420968" data-commentrating="-7" data-commentuserid="347821">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-7</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-420968">
                    <div class="moveup">
                    <div class="ttypography"><p>No good explanation! Only code! Worst tutorial.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-420968 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-420968 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-420968">
            <li>
<div class="comment">
    <table class="comment-table" commentid="421076" commentparentid="420968">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/satvik007" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/94b128dc6f18638b.jpg">        </a>
        <div><a href="https://codeforces.com/profile/satvik007" title="Expert satvik007" class="rated-user user-blue">satvik007</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/20/2018 20:57 UTC+7">13 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-421076" href="https://codeforces.com/blog/entry/44351?#comment-421076" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-420968" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="421076" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="421076" data-commentrating="0" data-commentuserid="492227">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-421076">
                    <div class="moveup">
                    <div class="ttypography"><p>If you have a doubt why not ask in the comments rather than whining about how bad the tutorial is.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-421076 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-421076 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-421076">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="421136" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/M_H_H_7" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/b37f7747bc462513.jpg">        </a>
        <div><a href="https://codeforces.com/profile/M_H_H_7" title="Expert M_H_H_7" class="rated-user user-blue">M_H_H_7</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/21/2018 08:48 UTC+7">13 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-421136" href="https://codeforces.com/blog/entry/44351?#comment-421136" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="421136" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="421136" data-commentrating="5" data-commentuserid="572976">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-421136">
                    <div class="moveup">
                    <div class="ttypography"><p>Nice tutorial!</p><p>and also happy <a href="https://en.wikipedia.org/wiki/Nowruz">Nowruz</a>:)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-421136 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-421136 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-421136">
            <li>
<div class="comment">
    <table class="comment-table" commentid="426077" commentparentid="421136">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Ehsan_sShuvo" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cad925cef2bc8465.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Ehsan_sShuvo" title="Specialist Ehsan_sShuvo" class="rated-user user-cyan">Ehsan_sShuvo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/21/2018 04:47 UTC+7">12 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-426077" href="https://codeforces.com/blog/entry/44351?#comment-426077" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-421136" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="426077" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="426077" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="426077" data-commentrating="0" data-commentuserid="323480">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-426077">
                    <div class="moveup">
                    <div class="ttypography"><p>Could you please explain 2no. style ? [Upd : Got it ]</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-426077 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-426077 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-426077">
            <li>
<div class="comment">
    <table class="comment-table" commentid="437694" commentparentid="426077">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/vivace_jr" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/vivace_jr" title="Expert vivace_jr" class="rated-user user-blue">vivace_jr</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/17/2018 02:14 UTC+7">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-437694" href="https://codeforces.com/blog/entry/44351?#comment-437694" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-426077" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="437694" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="437694" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="437694" data-commentrating="0" data-commentuserid="608488">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-437694">
                    <div class="moveup">
                    <div class="ttypography"><p>In 2nd style <a class="rated-user user-orange" href="https://codeforces.com/profile/Arpa" title="Master Arpa">Arpa</a> can you please explain?..when we do cnt[u]=cnt[heavy child] does this happen in O(1)?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-437694 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-437694 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-437694">
            <li>
<div class="comment">
    <table class="comment-table" commentid="437695" commentparentid="437694">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/vivace_jr" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/vivace_jr" title="Expert vivace_jr" class="rated-user user-blue">vivace_jr</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/17/2018 02:15 UTC+7">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-437695" href="https://codeforces.com/blog/entry/44351?#comment-437695" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-437694" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="437695" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="437695" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="437695" data-commentrating="0" data-commentuserid="608488">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-437695">
                    <div class="moveup">
                    <div class="ttypography"><p>if yes -&gt; how? else what the benefit of doing this? upd[got it]</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-437695 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-437695 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-437695">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="426090" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Ehsan_sShuvo" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/cad925cef2bc8465.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Ehsan_sShuvo" title="Specialist Ehsan_sShuvo" class="rated-user user-cyan">Ehsan_sShuvo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/21/2018 05:39 UTC+7">12 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-426090" href="https://codeforces.com/blog/entry/44351?#comment-426090" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="426090" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="426090" data-commentrating="0" data-commentuserid="323480">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-426090">
                    <div class="moveup">
                    <div class="ttypography"><p>If i do my code using 
2nd approach , shouldn't my problem be static ? And for query operation ,
 we will do offline query , won't that ? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-426090 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-426090 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-426090">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="429261" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Azurey" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/dbe37b4eaba7d7.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Azurey" title="Candidate Master Azurey" class="rated-user user-violet">Azurey</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/08/2018 23:38 UTC+7">12 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-429261" href="https://codeforces.com/blog/entry/44351?#comment-429261" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="429261" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="429261" data-commentrating="8" data-commentuserid="469008">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-429261">
                    <div class="moveup">
                    <div class="ttypography"><p>For those who still confused about the time complexity, I found <a href="https://codeforces.com/blog/entry/57955?#comment-416293">this</a> explanation by <a class="rated-user user-orange" href="https://codeforces.com/profile/radoslav11" title="Master radoslav11">radoslav11</a> helps a lot.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-429261 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-429261 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-429261">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="429271" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/a.kleber.d" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/200be0d4ddad2365.jpg">        </a>
        <div><a href="https://codeforces.com/profile/a.kleber.d" title="Specialist a.kleber.d" class="rated-user user-cyan">a.kleber.d</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/09/2018 01:27 UTC+7">12 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-429271" href="https://codeforces.com/blog/entry/44351?#comment-429271" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="429271" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="429271" data-commentrating="0" data-commentuserid="585437">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-429271">
                    <div class="moveup">
                    <div class="ttypography"><p>What is col[v]?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-429271 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-429271 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-429271">
            <li>
<div class="comment">
    <table class="comment-table" commentid="429521" commentparentid="429271">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Azurey" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/dbe37b4eaba7d7.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Azurey" title="Candidate Master Azurey" class="rated-user user-violet">Azurey</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/09/2018 16:28 UTC+7">12 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-429521" href="https://codeforces.com/blog/entry/44351?#comment-429521" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-429271" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="429521" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="429521" data-commentrating="0" data-commentuserid="469008">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-429521">
                    <div class="moveup">
                    <div class="ttypography"><p>Color of the v-th vertex</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-429521 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-429521 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-429521">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="434803" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/_Na2Th" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/c3a88cb3c98414a1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/_Na2Th" title="Expert _Na2Th" class="rated-user user-blue">_Na2Th</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/01/2018 07:24 UTC+7">11 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-434803" href="https://codeforces.com/blog/entry/44351?#comment-434803" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="434803" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="434803" data-commentrating="0" data-commentuserid="288169">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-434803">
                    <div class="moveup">
                    <div class="ttypography"><p>I loved the way you used
 the Euler tour sequence to iterate through the subtrees. My 2 cents is a
 way to use C++ to implement this nicely. The main idea is to use a 
structure, that keeps pointers instead of <code class="tt">st[v]</code> and <code class="tt">ft[v]</code>, and to give it a begin() and end() member function, so that you can iterate through it with</p> <pre><code class="prettyprint"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> T</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> u </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" is in the subtree of "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span></code></pre><p>To
 actually solve the problem, maybe in a Heavy-Light style, I kept also 
for each vertices a pointer to the leaf of its heavy-path, so that I 
could only change the answer in the leaf.</p><p>My full implementation of lomsat gelral can be found <a href="https://gist.github.com/nathanPro/d2055449b3a2eea9a5b08db8989d87fc">here</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-434803 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-434803 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-434803">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="437936" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/yaksha" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/35f0d64f1f410b9c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/yaksha" title="Candidate Master yaksha" class="rated-user user-violet">yaksha</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/17/2018 16:41 UTC+7">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-437936" href="https://codeforces.com/blog/entry/44351?#comment-437936" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="437936" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="437936" data-commentrating="0" data-commentuserid="595919">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-437936">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi , <a class="rated-user user-orange" href="https://codeforces.com/profile/Arpa" title="Master Arpa">Arpa</a>, I used this technique to solve <a href="https://codeforces.com/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a>,
 its a very neat technique.. but wont this get a MLE? I am getting a MLE
 with the O(nlog^2n0 method ,.. I saw your solution and I see its the 
same as mine, but mine gets MLE.. My solution :- <a href="https://codeforces.com/contest/600/submission/39325497" title="Submission 39325497 by yaksha">39325497</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-437936 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-437936 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-437936">
            <li>
<div class="comment">
    <table class="comment-table" commentid="439511" commentparentid="437936">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/dmkozyrev" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/731eafe276fed3df.jpg">        </a>
        <div><a href="https://codeforces.com/profile/dmkozyrev" title="Master dmkozyrev" class="rated-user user-orange">dmkozyrev</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/23/2018 23:24 UTC+7">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-439511" href="https://codeforces.com/blog/entry/44351?#comment-439511" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-437936" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="439511" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="439511" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="439511" data-commentrating="5" data-commentuserid="633429">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-439511">
                    <div class="moveup">
                    <div class="ttypography"><p>Solutions for 
Educational Codeforces Round 2 is private, nobody can't see your code. 
Perhaps you do not use pointers, dynamic memory allocation, and memory 
cleanup. In this technique it is forbidden to copy huge containers.</p><p>I solved this problem with Euler tour on tree and Mo algorithm in <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3b0bdf23003450b9c6db3c961c80e4c6bdd8ce7d.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> time and <span class="tex-span"><i>O</i>(<i>n</i>)</span> memory. <a href="https://github.com/dmkz/olymp/blob/master/codeforces.com/Educational%20Codeforces%20Round%2002/e.cpp">Code</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-439511 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-439511 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-439511">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="441323" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hackerwizard" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/b7c2eed34c29754c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hackerwizard" title="Expert hackerwizard" class="rated-user user-blue">hackerwizard</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/29/2018 22:05 UTC+7">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-441323" href="https://codeforces.com/blog/entry/44351?#comment-441323" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="441323" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="441323" data-commentrating="0" data-commentuserid="627027">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-441323">
                    <div class="moveup">
                    <div class="ttypography"><p>Great blog but I am not 
able to understand the logic behind the O(nlogn) solution it would be a 
great help if anyone can explain it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-441323 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-441323 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-441323">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="446043" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/The_Wolfpack" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e234d47358480cbc.jpg">        </a>
        <div><a href="https://codeforces.com/profile/The_Wolfpack" title="Expert The_Wolfpack" class="rated-user user-blue">The_Wolfpack</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/18/2018 19:30 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-446043" href="https://codeforces.com/blog/entry/44351?#comment-446043" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="446043" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="446043" data-commentrating="0" data-commentuserid="512608">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-446043">
                    <div class="moveup">
                    <div class="ttypography"><p>I have a question for style 3 i.e HLD style.<br>I'm
 not so sure what's happening in there, I have 2 assumptions. Both of 
them are wrong, so it would great if someone could point out the mistake
 and explain what's right. </p><p>We are in root. </p> <ol>   <li><p>We 
first go down the light edges of root and when we finish with them, we 
clear the cnt array, so there is absolutely nothing left in it and then 
we proceed to the heavy child of the root and then we just update cnt 
array.<br>Now we go back to the light edges of the root and (here's the 
problem) as the cnt array only contains information for the heavy child 
of the root, we must go through EVERY vertex in subtrees of light 
children of the root. If we don't go to the heavy children in the 
subtrees (as it proposes in tutorial?), then the answer is wrong, as we 
didn't count them (remember that we cleared the cnt array).</p></li>   <li><p>We first go down the light edges of the root, but this time, for every heavy child, we keep the information.<br>But
 then as we proceed to the heavy child of the root, the array cnt won't 
be empty and the answer for heavy child will be incorrect. </p></li> </ol></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-446043 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-446043 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-446043">
            <li>
<div class="comment">
    <table class="comment-table" commentid="446044" commentparentid="446043">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/18/2018 19:57 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-446044" href="https://codeforces.com/blog/entry/44351?#comment-446044" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-446043" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="446044" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="446044" data-commentrating="9" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+9</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-446044">
                    <div class="moveup">
                    <div class="ttypography"><p>Consider you entered vertex <span class="tex-span"><i>v</i></span>, let it's heavy child <span class="tex-span"><i>h</i></span>. First, go to all child of <span class="tex-span"><i>v</i></span> except <span class="tex-span"><i>h</i></span> and calculate the answer for them and each time clear the <span class="tex-span"><i>cnt</i></span> array. Then go to <span class="tex-span"><i>h</i></span> and calculate the answer and don't clear the <span class="tex-span"><i>cnt</i></span> array. Then traverse all of the subtree of <span class="tex-span"><i>v</i></span> except subtree of <span class="tex-span"><i>h</i></span>, and add them to <span class="tex-span"><i>cnt</i></span>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-446044 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-446044 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-446044">
            <li>
<div class="comment">
    <table class="comment-table" commentid="446046" commentparentid="446044">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/The_Wolfpack" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e234d47358480cbc.jpg">        </a>
        <div><a href="https://codeforces.com/profile/The_Wolfpack" title="Expert The_Wolfpack" class="rated-user user-blue">The_Wolfpack</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/18/2018 20:04 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-446046" href="https://codeforces.com/blog/entry/44351?#comment-446046" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-446044" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="446046" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="446046" data-commentrating="13" data-commentuserid="512608">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-446046">
                    <div class="moveup">
                    <div class="ttypography"><p>I got it, thanks for the quick reply!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-446046 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-446046 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-446046">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="446058" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Tanmoy_Datta" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/f1647a69c7eb4d6f.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Tanmoy_Datta" title="Expert Tanmoy_Datta" class="rated-user user-blue">Tanmoy_Datta</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/18/2018 21:43 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-446058" href="https://codeforces.com/blog/entry/44351?#comment-446058" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="446058" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="446058" data-commentrating="18" data-commentuserid="251402">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-446058">
                    <div class="moveup">
                    <div class="ttypography"><p>Another problem can be solved with this technique. <a class="rated-user user-violet" href="https://codeforces.com/profile/Arpa" title="Candidate Master Arpa">Arpa</a> please add this one in the list. </p><p><a href="https://codeforces.com/contest/1009/problem/F">http://codeforces.com/contest/1009/problem/F</a> (Dominant Indices)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-446058 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-446058 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-446058">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="446059" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/light--stars--dark" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/7a9386b2f05e5e20.jpg">        </a>
        <div><a href="https://codeforces.com/profile/light--stars--dark" title="Unrated, light--stars--dark" class="rated-user user-black">light--stars--dark</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/18/2018 21:47 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-446059" href="https://codeforces.com/blog/entry/44351?#comment-446059" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="446059" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="446059" data-commentrating="0" data-commentuserid="676832">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-446059">
                    <div class="moveup">
                    <div class="ttypography"><p>Can someone explain why this solution <a href="https://codeforces.com/contest/600/submission/40510312" title="Submission 40510312 by light--stars--dark">40510312</a> is getting TLE on problem <a href="https://codeforces.com/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a>. I'm using style 4.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-446059 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-446059 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-446059">
            <li>
<div class="comment">
    <table class="comment-table" commentid="446102" commentparentid="446059">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/lrvideckis" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/28d58c2bc0c20c1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/lrvideckis" title="Master lrvideckis" class="rated-user user-orange">lrvideckis</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/19/2018 04:20 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-446102" href="https://codeforces.com/blog/entry/44351?#comment-446102" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-446059" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="446102" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="446102" data-commentrating="8" data-commentuserid="522387">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-446102">
                    <div class="moveup">
                    <div class="ttypography"><p>Can't view your submission</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-446102 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-446102 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-446102">
            <li>
<div class="comment">
    <table class="comment-table" commentid="446157" commentparentid="446102">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/light--stars--dark" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/7a9386b2f05e5e20.jpg">        </a>
        <div><a href="https://codeforces.com/profile/light--stars--dark" title="Unrated, light--stars--dark" class="rated-user user-black">light--stars--dark</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/19/2018 23:09 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-446157" href="https://codeforces.com/blog/entry/44351?#comment-446157" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-446102" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="446157" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="446157" data-commentrating="5" data-commentuserid="676832">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-446157">
                    <div class="moveup">
                    <div class="ttypography"><p>Firstly, thank you for reaching out to help :). I got my mistake. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-446157 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-446157 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-446157">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="447460" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ChandyShot" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ChandyShot" title="Specialist ChandyShot" class="rated-user user-cyan">ChandyShot</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2018 17:16 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-447460" href="https://codeforces.com/blog/entry/44351?#comment-447460" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="447460" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="447460" data-commentrating="0" data-commentuserid="421578">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-447460">
                    <div class="moveup">
                    <div class="ttypography"><p>I'm continuously getting TLE in test case 30 in <a href="https://codeforces.com/contest/570/problem/D">570 : D : Tree Request</a>
 (The second one given in the blog practice problem) while implementing 
through DSU similar to what is given here. Submission Id : 40780911 , 
can somebody make a look over this and provide hint to optimize it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-447460 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-447460 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-447460">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="485252" commentparentid="447460">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/m0nk3ydluffy" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/1dc9c83bc5997ee0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/m0nk3ydluffy" title="Expert m0nk3ydluffy" class="rated-user user-blue">m0nk3ydluffy</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Jan/17/2019 21:57 UTC+7">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-485252" href="https://codeforces.com/blog/entry/44351?#comment-485252" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-447460" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="485252" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="485252" data-commentrating="0" data-commentuserid="572484">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-485252">
                    <div class="moveup">
                    <div class="ttypography"><p>My solution passed the time limit after replacing <strong>endl</strong> with <strong>"\n"</strong>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-485252 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-485252 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-485252">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="447492" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/rajarshi_basu" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/rajarshi_basu" title="Candidate Master rajarshi_basu" class="rated-user user-violet">rajarshi_basu</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2018 21:29 UTC+7">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-447492" href="https://codeforces.com/blog/entry/44351?#comment-447492" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="447492" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="447492" data-commentrating="0" data-commentuserid="364622">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-447492">
                    <div class="moveup">
                    <div class="ttypography"><p>This blog was a bit 
code-heavy for me when I first read this. Hence I have tried to simplify
 the concept a bit more in a more textual fashion in my own tutorial 
spin-off. I have tried to provide the intuition behind small-to-large 
merging including small to large on trees, also knows as DSU on trees.</p><p>However I. haven't provided any code as the code given by the OP is more than enough.<br><a href="https://codingwithrajarshi.blogspot.com/2018/06/small-to-large.html">DSU-on-Tree-Intuition</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-447492 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-447492 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-447492">
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="474712" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sagarthecoder2" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/61d8d75ce582d9ea.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sagarthecoder2" title="Pupil sagarthecoder2" class="rated-user user-green">sagarthecoder2</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 00:56 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474712" href="https://codeforces.com/blog/entry/44351?#comment-474712" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474712" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474712" data-commentrating="0" data-commentuserid="496991">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474712">
                    <div class="moveup">
                    <div class="ttypography"><p>Method -3</p><p>WHy here use bigchild??</p><p>and why use "keep==0 " ??</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474712 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474712 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474712">
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="474743" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/mra2322001" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/aac17aabee6a9380.jpg">        </a>
        <div><a href="https://codeforces.com/profile/mra2322001" title="Specialist mra2322001" class="rated-user user-cyan">mra2322001</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 03:47 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474743" href="https://codeforces.com/blog/entry/44351?#comment-474743" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474743" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474743" data-commentrating="0" data-commentuserid="514311">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474743">
                    <div class="moveup">
                    <div class="ttypography"><p>sorry but you absolutely
 wrong about the complexity, i know the trick merge smaller to greater 
but it works when you don't for(i = 0; i &lt; greater.size(); i++) 
again, but here in O(nlogn ^ 2) you use cnt[v] = cnt[bigchild], it equal
 to "for(int i = 0; i &lt; cnt[bigchild].size(); i++) {} ", so it's not 
O(nlogn ^2)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474743 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474743 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474743">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="474745" commentparentid="474743">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 03:52 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474745" href="https://codeforces.com/blog/entry/44351?#comment-474745" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-474743" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474745" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474745" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474745">
                    <div class="moveup">
                    <div class="ttypography"><p>Note that <span class="tex-span"><i>cnt</i>[<i>v</i>]</span> is a pointer.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474745 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474745 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474745">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="474747" commentparentid="474745">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/mra2322001" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/aac17aabee6a9380.jpg">        </a>
        <div><a href="https://codeforces.com/profile/mra2322001" title="Specialist mra2322001" class="rated-user user-cyan">mra2322001</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 03:56 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474747" href="https://codeforces.com/blog/entry/44351?#comment-474747" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-474745" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474747" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474747" data-commentrating="0" data-commentuserid="514311">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474747">
                    <div class="moveup">
                    <div class="ttypography"><p>you mean that it take O(logn) time ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474747 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474747 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474747">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="474748" commentparentid="474747">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 03:57 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474748" href="https://codeforces.com/blog/entry/44351?#comment-474748" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-474747" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474748" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474748" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474748">
                    <div class="moveup">
                    <div class="ttypography"><p><span class="tex-span"><i>O</i>(1)</span>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474748 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474748 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474748">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="474750" commentparentid="474748">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/mra2322001" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/aac17aabee6a9380.jpg">        </a>
        <div><a href="https://codeforces.com/profile/mra2322001" title="Specialist mra2322001" class="rated-user user-cyan">mra2322001</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 03:58 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474750" href="https://codeforces.com/blog/entry/44351?#comment-474750" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-474748" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474750" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474750" data-commentrating="0" data-commentuserid="514311">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474750">
                    <div class="moveup">
                    <div class="ttypography"><p>got it, but how about the vector in your O(nlogn) time ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474750 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474750 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474750">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="474751" commentparentid="474750">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 03:58 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474751" href="https://codeforces.com/blog/entry/44351?#comment-474751" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-474750" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474751" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474751" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474751">
                    <div class="moveup">
                    <div class="ttypography"><p>It's pointer too, isn't it?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474751 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474751 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474751">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="474752" commentparentid="474751">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/mra2322001" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/aac17aabee6a9380.jpg">        </a>
        <div><a href="https://codeforces.com/profile/mra2322001" title="Specialist mra2322001" class="rated-user user-cyan">mra2322001</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Dec/03/2018 03:59 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-474752" href="https://codeforces.com/blog/entry/44351?#comment-474752" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-474751" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="474752" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="474752" data-commentrating="0" data-commentuserid="514311">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-474752">
                    <div class="moveup">
                    <div class="ttypography"><p>thanks a lot, I got it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-474752 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-474752 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-474752">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="487391" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/tanmay28" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/tanmay28" title="Expert tanmay28" class="rated-user user-blue">tanmay28</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Jan/27/2019 02:29 UTC+7">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-487391" href="https://codeforces.com/blog/entry/44351?#comment-487391" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="487391" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="487391" data-commentrating="0" data-commentuserid="620143">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-487391">
                    <div class="moveup">
                    <div class="ttypography"><p>Can someone explain, why will the complexity of the first code will be O(nlog^2n)?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-487391 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-487391 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-487391">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="487400" commentparentid="487391">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Jan/27/2019 02:53 UTC+7">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-487400" href="https://codeforces.com/blog/entry/44351?#comment-487400" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-487391" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="487400" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="487400" data-commentrating="3" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-487400">
                    <div class="moveup">
                    <div class="ttypography"><p>Every vertex will appear in <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/755c0e72a8f6c5be4007a41acbae4bf024107b8c.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> <span class="tex-span"><i>cnt</i></span>'s, every time we want to insert a vertex it costs <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/755c0e72a8f6c5be4007a41acbae4bf024107b8c.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">, so the whole time complexity is <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/a95393bb50b53f9807f3f0fdabb9566b68401cf0.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-487400 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-487400 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-487400">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="487408" commentparentid="487400">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/tanmay28" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/tanmay28" title="Expert tanmay28" class="rated-user user-blue">tanmay28</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Jan/27/2019 03:11 UTC+7">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-487408" href="https://codeforces.com/blog/entry/44351?#comment-487408" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-487400" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="487408" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="487408" data-commentrating="0" data-commentuserid="620143">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-487408">
                    <div class="moveup">
                    <div class="ttypography"><ol>   <li>That means, if I use unordered_map my complexity will reduce to O(nlogn)?</li>   <li>How can you say that every vertex will appear in log(n) cnt's?</li> </ol></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-487408 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-487408 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-487408">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="487415" commentparentid="487408">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Jan/27/2019 03:28 UTC+7">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-487415" href="https://codeforces.com/blog/entry/44351?#comment-487415" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-487408" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="487415" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="487415" data-commentrating="3" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-487415">
                    <div class="moveup">
                    <div class="ttypography"><ol>   <li>Yes.</li>   <li>Read the proof of that for each vertex there is at most <img class="tex-formula" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/755c0e72a8f6c5be4007a41acbae4bf024107b8c.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> light edges in the path between this vertex to root: <a href="https://en.wikipedia.org/wiki/Heavy_path_decomposition">Link</a>.</li> </ol></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-487415 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-487415 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-487415">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="487416" commentparentid="487415">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/tanmay28" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/tanmay28" title="Expert tanmay28" class="rated-user user-blue">tanmay28</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Jan/27/2019 03:29 UTC+7">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-487416" href="https://codeforces.com/blog/entry/44351?#comment-487416" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-487415" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="487416" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="487416" data-commentrating="0" data-commentuserid="620143">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-487416">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-487416 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-487416 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-487416">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="487410" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/savinov" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/e768ec23bd7abf13.jpg">        </a>
        <div><a href="https://codeforces.com/profile/savinov" title="Grandmaster savinov" class="rated-user user-red">savinov</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Jan/27/2019 03:16 UTC+7">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-487410" href="https://codeforces.com/blog/entry/44351?#comment-487410" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="487410" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="487410" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="487410" data-commentrating="8" data-commentuserid="49874">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-487410">
                    <div class="moveup">
                    <div class="ttypography"><p>This particular problem can be solved in linear time:</p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
    </span><span class="com">// Subtract cnt[c] for query here, e.g. answer[query] -= cnt[c];</span><span class="pln">
    
    cnt</span><span class="pun">[</span><span class="pln">col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]]++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">

    </span><span class="com">// Add cnt[c] for query here, e.g. answer[query] += cnt[c];</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-487410 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-487410 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-487410">
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="502160" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/idLe." style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/6209a9d275391988.jpg">        </a>
        <div><a href="https://codeforces.com/profile/idLe." title="Expert idLe." class="rated-user user-blue">idLe.</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Mar/27/2019 06:35 UTC+7">4 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-502160" href="https://codeforces.com/blog/entry/44351?#comment-502160" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="502160" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="502160" data-commentrating="0" data-commentuserid="468008">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-502160">
                    <div class="moveup">
                    <div class="ttypography"><p>Can somebody help me understand why my solution <a href="https://codeforces.com/contest/246/submission/51874074" title="Submission 51874074 by idLe.">51874074</a> for problem <a href="https://codeforces.com/contest/246/problem/E" title="Codeforces Round 151 (Div. 2)">246E - Blood Cousins Return</a> gets WA on test 50? I tried to implement the Heavy Light Decomposition style dsu</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-502160 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-502160 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-502160">
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="504716" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gowithchristbrah" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/3b192aa78fa678f8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/gowithchristbrah" title="Specialist gowithchristbrah" class="rated-user user-cyan">gowithchristbrah</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Apr/10/2019 19:23 UTC+7">2 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-504716" href="https://codeforces.com/blog/entry/44351?#comment-504716" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="504716" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="504716" data-commentrating="0" data-commentuserid="520747">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-504716">
                    <div class="moveup">
                    <div class="ttypography"><p>How to answer online queries using this technique??</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-504716 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-504716 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-504716">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="504725" commentparentid="504716">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/608989d694c02e01.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Apr/10/2019 21:25 UTC+7">2 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-504725" href="https://codeforces.com/blog/entry/44351?#comment-504725" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-504716" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="504725" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="504725" data-commentrating="4" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+4</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-504725">
                    <div class="moveup">
                    <div class="ttypography"><p>I didn't find till today.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-504725 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-504725 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-504725">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="505648" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/nsut_coder" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/nsut_coder" title="Expert nsut_coder" class="rated-user user-blue">nsut_coder</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Apr/16/2019 00:08 UTC+7">11 days ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-505648" href="https://codeforces.com/blog/entry/44351?#comment-505648" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="505648" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="505648" data-commentrating="0" data-commentuserid="698365">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-505648">
                    <div class="moveup">
                    <div class="ttypography"><p>why did he declare every
 time using pointer, can't we simply declare array of map for first 
approach as map&lt;int,int&gt; cnt[maxx] instead of 
map&lt;int,int&gt;*cnt[maxx] ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-505648 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-505648 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-505648">
            <li>
<div class="comment">
    <table class="comment-table highlight-blue" commentid="505650" commentparentid="505648">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhayps" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/8304c17f4d601693.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhayps" title="Expert abhayps" class="rated-user user-blue">abhayps</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Apr/16/2019 00:16 UTC+7">11 days ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-505650" href="https://codeforces.com/blog/entry/44351?#comment-505650" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-505648" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="505650" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="505650" data-commentrating="8" data-commentuserid="465574">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-505650">
                    <div class="moveup">
                    <div class="ttypography"><p>Due to this line, cnt[v]
 = cnt[bigChild]. Because we are using pointer, we only pass the 
reference. In other case, whole map will be copied(time complexity: 
linear in size of map).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-505650 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-505650 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-505650">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table highlight-blue" commentid="506569" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Underdog_eagle" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/9ea981efff3b31ec.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Underdog_eagle" title="Specialist Underdog_eagle" class="rated-user user-cyan">Underdog_eagle</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    <span style="font-weight: bold;">new</span>,
                    <span class="item"><span class="format-humantime" title="Apr/21/2019 06:26 UTC+7">6 days ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-506569" href="https://codeforces.com/blog/entry/44351?#comment-506569" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="506569" data-size="12" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="506569" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="506569" data-commentrating="0" data-commentuserid="418958">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-506569">
                    <div class="moveup">
                    <div class="ttypography"><p>Why is <a href="https://codeforces.com/contest/600/submission/53068442">my code</a> getting TLE for problem <a href="https://codeforces.com/contest/600/problem/E">600E — Lomsat gelral</a>? I'm using the technique no. 1 from this tutorial.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-506569 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-506569 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-506569">
    </ul>
</div>
    <br>

<div id="editBox-44528" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview44528 = true;
var lastPreviewContent44528 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=44528] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=44528] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});

    $("div[commentableId=44528] a.editCommentLink").click(function () {
        if (confirm("You may edit your comment only for fixing grammar mistakes or small changes. Do not change the main idea of your comment. All previous revisions are available for others. Are you sure you want to edit comment?")) {
            Codeforces.facebox("#editBox-44528", "//st.codeforces.com/s/12135");
            firstPreview44528 = true;
            lastPreviewContent44528 = '';
            $("#facebox #editBox-44528 textarea.wysiwyg").drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});
            var commentId = $(this).attr("commentId");
            $.post("/data/comment-data", {action: "content", commentId: commentId}, function(json) {
                if (json["success"] != "true") {
                    alert(json["error"]);
                    return;
                }
                var content = json["content"];
                $("#facebox #editBox-44528 textarea.wysiwyg").val(content);

                if (json["allowChangeLocale"] == "true") {
                    $("#facebox #editBox-44528 .commentLocale").css("display", "");
                }

                var commentLocale = json["commentLocale"];
                if (commentLocale == "en") {
                    $("#facebox #editBox-44528 .commentLocale input[value=en]").prop("checked", true);
                } else {
                    $("#facebox #editBox-44528 .commentLocale input[value=ru]").prop("checked", true);
                }

                $("#facebox #editBox-44528 textarea.wysiwyg").css("width", "97%").markItUp(commentSettings).css("height", "200px");

                $("#facebox #editBox-44528 input[name='save']").click(function () {
                    var content = $("#facebox #editBox-44528 textarea.wysiwyg").val();
                    var locale = $("#facebox #editBox-44528 input[name=locale]:checked").val();
                    $.post(
                        "/data/comment-data",
                        {action: "update", commentId: commentId, content: content, locale: locale, subscribedCommentLinkInfix: "3vxkI82lD2ijfZ5qDS1g4Ngdtfo*/blog/entry/44351"},
                        function(json) {
                            if (json.success == "true") {
                                Codeforces.reload();
                            } else {
                                $("#facebox #editBox-44528 div.error__content").text(json.error__content);
                                window.updateTypography();
                            }
                        },
                        "json"
                    );

                    return false;
                });

                $("#facebox #editBox-44528 input[name='preview']").click(function () {
                    var content = $("#facebox #editBox-44528 textarea[name='editContent']").val();
                    if (firstPreview44528 || lastPreviewContent44528 != content) {
                        firstPreview44528 = false;
                        lastPreviewContent44528 = content;
                        commentPreviewShow44528(commentId);
                    }
                    return false;
                });
            }, "json");
        }
        return false;
    });

    var commentPreviewShow44528 = function(commentId) {
        var content = $("#facebox #editBox-44528 textarea[name='editContent']").val();
        var replyLocale = $("#facebox #editBox-44528 input[name=locale]:checked").val();
        $.post(
        "/data/comment-data", {action: "preview", replyLocale: replyLocale, content: content, commentId: commentId},
            function(json) {
                if (json.success == "true") {
                    $("#facebox #editBox-44528 .previewBody").html("<div style='font-size: 1.2rem;'>Comment preview:<hr/></div><div class='comment-content' style='position: relative; bottom: 12px;'>" + json.response + "</div>").fadeIn();
                    Codeforces.setupSpoilers($("#facebox #editBox-44528 .previewBody"));
                    MathJax.Hub.Typeset();
                } else {
                    $("#facebox #editBox-44528 .previewBody").html("<div><b style='color:red;'>Comment preview error:</b><hr/><div>" + json.error__content).fadeIn();
                }
                window.updateTypography();
            },
            "json"
        );
        return false;
    };

    $("div[commentableId=44528] a.deleteCommentLink").click(function () {
        if (confirm("Are you sure you want to delete this comment?")) {
            var commentId = $(this).attr("commentId");
            $.post("/data/comment-data", {action: "delete", commentId: commentId}, function(json) {
                if (json.success == "true") {
                    Codeforces.reload();
                } else {
                    alert(json.error);
                }
            }, "json");
        }
        return false;
    });

        });
    </script>

<div class="comment comment-reply-prototype" style="display:none;">
        <table class="comment-table" style="width: 100%;">
            <tbody><tr>
                <td class="left">
    <div class="avatar">
        <a href="https://codeforces.com/profile/24434" style="position: relative;">
<img src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/c7a705f60ecae457.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/24434" title="Candidate Master 24434" class="rated-user user-violet">24434</a></div>
    </div>
                </td>
                <td class="right" style="padding:1em 0 1em 1em;">
                    <form action="" method="post" class="commentReplyForm"><input type="hidden" name="csrf_token" value="f166c9ad168de66629c48afdd4741d0f">
                        <input type="hidden" name="commentReplyFormSubmitted" value="true">
                        <input type="hidden" name="commentId">
                        <input type="hidden" name="hasMaximalDepth">
                        <input type="hidden" name="commentableId">
                        <table class="table-form" style="width:100%;">
                            <tbody><tr>
                                <td style="width: 1px">&nbsp;</td><td>
                                <div style="position: relative; top: 0.5em;left:4px;">
                                    <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
                                    <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
                                </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 1px;">&nbsp;</td><td>
                                    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
                                    <textarea data-drafts-id="CommentReplyFrame" class="no-wysiwyg" name="replyContent" rows="10" style="width: 100%;"></textarea>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" valign="top">
                                    <div style="float: left;" class="small">
         <div class="shiftUp error__commentWithId">
             <span class="error for__commentWithId " style="display: none;">&nbsp;</span>
             <span class="notice for__commentWithId ">&nbsp;</span>
         </div>
         <div class="shiftUp error__content">
             <span class="error for__content " style="display: none;">&nbsp;</span>
             <span class="notice for__content ">&nbsp;</span>
         </div>
                                    </div>
                                    <div style="position: relative; right: 4px;text-align:right;">
                                        <div style="position: relative; display: inline-block;">
                                            <img style="left:-24px;" class="ajax-loading-gif" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/ajax-loading-16x16.gif">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="submit" name="submit" value="Post">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="button" class="preview" value="Preview">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="button" class="cancel" value="Cancel">
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    <input type="hidden" name="_tta" value="577"></form>
                </td>
            </tr>
        </tbody></table>
</div>

        <script type="text/javascript">
            $(function() {
                window._ftaa = "oflqb2dkfzchi3wlwc";
            })
        </script>

        <script type="text/javascript">
            $(function() {
                window._bfaa = "461dcda7b859165264a36718c35835a1";
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    var commentPreviewListener = function(div) {
        var content = div.find("textarea").val();
        var replyLocale = div.find('input[name=locale]:checked').val();

        $.post(
            "/data/comment-data",
            {action: "preview", replyLocale: replyLocale, content: content},
            function(json) {
                if (json.success == "true") {
                    div.find(".previewBody").html("<div style='font-size: 1.2rem;'>Comment preview:<hr/></div><div class='comment-content' style='position: relative; bottom: 12px;'>" + json.response + "</div>").fadeIn();
                    Codeforces.setupSpoilers(div.find(".previewBody"));
                    MathJax.Hub.Typeset();
                } else {
                    div.find(".previewBody").html("<div><b style='color:red;'>Comment preview error:</b><hr/><div>" + json.error__content).fadeIn();
                }
                window.updateTypography();
            },
            "json"
        );

        return false;
    }

    var commentReplyFormSubmitListener = function () {
        var id = $(this).attr("id");
        var hasMaximalDepth = $(this).find("input[name=hasMaximalDepth]").val() || "false";
        var commentWithId = $(this).find("input[name=commentId]").val() || "";
        var content = $(this).find("textarea").val();
        var commentableId = $(this).find("input[name=commentableId]").val() || 0;
        var commentReplyFormSubmitted = $(this).find("input[name=commentReplyFormSubmitted]").val();
        var replyLocale = $(this).find('input[name=locale]:checked').val();

        var postNewCommentReply = function () {
            $.post(
                "/data/new-comment-reply",
                {ftaa: window._ftaa, bfaa: window._bfaa, commentWithId:     commentWithId, content: content, commentReplyFormSubmitted: commentReplyFormSubmitted, _tta: Codeforces.tta(), replyLocale: replyLocale, commentableId: commentableId, subscribedCommentLinkInfix: "3vxkI82lD2ijfZ5qDS1g4Ngdtfo*/blog/entry/44351"},
                function(data) {
                    var invalid = Codeforces.setAjaxFormErrors("#" + id , data);
                    var newCommentWithId = data.newCommentWithId;
                    if (!invalid) {
                        var s = window.location.toString();
                        var found = false;
                        for (var i = 0; i < s.length; i++)
                            if (s.charAt(i) == '#') {
                                found = true;
                                index = i;
                            }
                        if (!found) {
                            s += "#" + newCommentWithId;
                        } else {
                            s = s.substr(0, index + 1) + newCommentWithId;
                        }
                        window.location = s;
                        window.location.reload();
                    }
                },
                "json"
            );
        };

        $.post("/data/checkTextForRussianLanguage", { text: content }, function(response) {
            var isRussianComment = response["isRussianComment"];
            if (replyLocale == "en" && isRussianComment == "true") {
                Codeforces.confirm(
                    "Are you sure that your comment in English?",
                    postNewCommentReply, function () { },
                    "Yes", "No"
                );
            } else if (replyLocale == "ru" && isRussianComment == "false") {
                Codeforces.confirm(
                    "Are you sure that your comment in Russian?",
                    postNewCommentReply, function () { },
                    "Yes", "No"
                );
            } else {
                postNewCommentReply();
            }
        }, "json");

        return false;
    }
    $("a.new-root-comment").click(function () {
            var a = $(this);
            a.hide();

            var commentableId = $(".comments").attr("commentableId");
            var e = $(".comment-reply-prototype").clone().removeClass("comment-reply-prototype");

            var div = $("<div></div>").append(e);
            var p = $(this).parent();
            p.prepend(div);
            e.show();

            e.find("input[value=en]").attr("checked", true);
            e.find("input[name=commentableId]").attr("value", commentableId);
            e.find("form").submitOnce(commentReplyFormSubmitListener, true);
            e.find("form").attr("id", "form-" + (new Date().getTime()));

            div.find('textarea.no-wysiwyg').css("width", "97%").markItUp(commentSettings).css("height", "200px");
            div.find('textarea.no-wysiwyg').removeClass("no-wysiwyg");
            div.find('textarea').drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});

            var first = true;
            div.find(".cancel").each(function () {
                if (first) {
                    $(this).click(function () {
                        div.remove();
                        a.show();
                        return false;
                    });
                    first = false;
                }
            });

            first = true;
            div.find(".preview").each(function () {
                if (first) {
                    $(this).click(function () {
                        commentPreviewListener(div);
                        return false;
                    });
                    first = false;
                }
            });
        return false;
    });

    $(".comment-table .reply a").click(function () {
            var classes = this.className.split(" ");
            var commentId = classes[0];
            var locale = classes[1];
            var hasMaximalDepth = classes[2];
            var commentableId = $(".comments").attr("commentableId");

            showReplyWindow = function () {
                $(".current-comment-reply").remove();
                var e = $(".comment-reply-prototype").clone().removeClass("comment-reply-prototype").addClass("current-comment-reply");

                var li = $("<li></li>").append(e);
                var ul = $(".comment ul." + commentId);
                ul.prepend(li);
                e.show();
                e.find("input[name=commentId]").attr("value", commentId);
                e.find("input[name=hasMaximalDepth]").attr("value", hasMaximalDepth);
                e.find("input[value=" + locale + "]").attr("checked", true);
                e.find("input[name=locale]").attr("readonly", true);
                e.find("input[name=locale]").attr("disabled", true);
                e.find("input[name=commentableId]").attr("value", commentableId);
                e.find("form").submitOnce(commentReplyFormSubmitListener, true);
                e.find("form").attr("id", "form-" + (new Date().getTime()));

                li.find('textarea').css("width", "97%").markItUp(commentSettings).css("height", "200px");

                setTimeout(function () {
                    li.find('textarea').drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});
                }, 1000);

                var first = true;
                ul.find(".cancel").each(function () {
                    if (first) {
                        $(this).click(function () {
                            li.remove();
                            return false;
                        });
                        first = false;
                    }
                });

                first = true;
                ul.find(".preview").each(function () {
                    if (first) {
                        $(this).click(function () {
                            commentPreviewListener(ul);
                        });
                        first = false;
                    }
                });
            }

            if (hasMaximalDepth == "true") {
                Codeforces.confirm("The debates reached maximal permitted depth, so your message and the message you are replying will be displayed on the same level. Are you sure you want to reply to the message?", showReplyWindow, function () { }, "Yes", "No");
            } else {
                showReplyWindow();
            }
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==330063;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "//st.codeforces.com/s/12135/images/actions/comment-voteup.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "//st.codeforces.com/s/12135/images/actions/comment-votedown.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==330063;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "//st.codeforces.com/s/12135/images/actions/comment-voteup-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "//st.codeforces.com/s/12135/images/actions/comment-votedown-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
    });

    $(".vote-for-comment").click(function () {
        var vote = $(this);
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var direction = $(this).attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==330063;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: direction, commentRating: commentRating}, function(data) {
            if (direction != 0 && !ownComment && data["success"] == "true") {
                vote.parent().find(".vote-for-comment").attr("voteDirection", 0);
                if (direction == 1)
                    vote.find("img").attr("src", "//st.codeforces.com/s/12135/images/actions/comment-voteup.png");
                else
                    vote.find("img").attr("src", "//st.codeforces.com/s/12135/images/actions/comment-votedown.png");
                vote.find("img").attr("popacity", "1.0");
                vote.find("img").css("opacity", "1.0");
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
</div>

<style type="text/css">
    .new-comments-box {
        padding: 0.5em;
        width: 22px;
        font-size: 1.3rem;
        font-weight: bold !important;

        position: fixed;
        top: 40%;
        right: 0;
        opacity: 0.2;
        color: white;
        text-align: center;

        border: 1px solid #222;
        background-color: #888 !important;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px;
    }

    .new-comments-box:hover {
        opacity: 1;
    }

    .new-comments-box .dir:hover {
        background: #3B5998 !important;
        cursor: pointer;
    }
</style>

<div class="new-comments-box" data-position="outside" data-index="-1" style="">
    <div class="up dir" title="Ctrl+Up">↑<hr></div>
    <div class="info" title="New comments">22</div>
    <div class="down dir" title="Ctrl+Down"><hr>↓</div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {
    function gotoComment(direction) {
        var box = $(".new-comments-box");
        var index = parseInt(box.attr("data-index"));
        if (index == -1)
            index = 0;
        else
            index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
        box.attr("data-index", index);
        var comment = $($(".comment .highlight-blue[commentId]").get(index));
        $('html, body').animate({
          'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
        });
        return false;
    }

    $(".new-comments-box .down").click(function () {
        return gotoComment(1);
    });

    $(".new-comments-box .up").click(function () {
        return gotoComment(-1);
    });

    $(document).keydown(function (e) {
         var code = (e.keyCode ? e.keyCode : e.which);
         if (e.ctrlKey) {
            if (code == 38 || code == 40) {
                gotoComment(code - 39);
            }
         }
    });

    var newCommentCount = $(".comment .highlight-blue[commentId]").length;
    if (newCommentCount > 0) {
        $(".new-comments-box .info").text(newCommentCount);
        $(".new-comments-box").show();
    }

    $('table.comment-table').mouseenter(function () {
        var comment = $(this);
        var cnt = 0;
        while (true) {
            var id = comment.attr("commentId");
            var parentId = comment.attr("commentParentId");
            comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
            if (parentId == -1) {
                break;
            }
            comment = $("table.comment-table[commentId=" + parentId + "]");
        }
        return false;
    });

    $('table.comment-table').mouseleave(function () {
        var comment = $(this);
        var cnt = 0;
        while (true) {
            var id = comment.attr("commentId");
            var parentId = comment.attr("commentParentId");
            comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
            if (parentId == -1) {
                break;
            }
            comment = $("table.comment-table[commentId=" + parentId + "]");
        }
        return false;
    });
        });
    </script>


    <script type="text/javascript">
        $(document).ready(function () {
    $(".topic-vote-up-44511").click(function () {
        $.post("/data/topic/vote", {topicId: 44511, _tta: Codeforces.tta(), topicRevisionId: 143333, vote: +1}, function(data) {
            Codeforces.showMessage(data);
        }, "json");
        return false;
    });
    $(".topic-vote-down-44511").click(function () {
        $.post("/data/topic/vote", {topicId: 44511, _tta: Codeforces.tta(), topicRevisionId: 143333, vote: -1}, function(data) {
            Codeforces.showMessage(data);
        }, "json");
        return false;
    });
        });
    </script>
</div>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2019 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Apr/26/2019 20:38:28<sup title="timezone offset" style="font-size:8px;">UTC+7</sup> (e1).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="https://codeforces.com/blog/entry/44351?mobile=true">mobile version</a>.</div>
                <div class="smaller"><a href="https://codeforces.com/privacy">Privacy Policy</a></div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div style="margin-top: 8px; padding-bottom: 20px; position: relative; left: 10px;">
                        <a href="https://telegram.org/"><img style="margin-right: 2em; width: 60px;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/telegram-100x100.png" alt="Telegram" title="Telegram"></a>
                        <a href="http://ifmo.ru/en/"><img style="width: 120px;" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/itmo_small_en-logo.png" alt="ИТМО" title="ИТМО"></a>
                    </div>
            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }
            Codeforces.focusOnError();
        });
    </script>

        <div class="userListsFacebox" style="display:none;">
            <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/control.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="[Tutorial]%20Sack%20(dsu%20on%20tree)%20-%20Codeforces_files/control-270.png">
                        <input style="padding:0;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                    <thead>
                    <tr>
                        <th class="top left right">Name</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
            </div>
        </div>
        <script type="application/javascript">
            $(function() {
                $(".userListMarker").click(function() {
                    $.post("/data/lists", {action: "findTouched"}, function(json) {
                        Codeforces.facebox(".userListsFacebox");
                        var tbody = $("#facebox tbody");
                        tbody.empty();
                        for (var i in json) {
                            tbody.append(
                                    $("<tr></tr>").append(
                                            $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                                    )
                            );
                        }
                        Codeforces.updateDatatables();
                        tbody.find("td").css("cursor", "pointer").click(function() {
                            document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                        });
                    }, "json");
                });
            });
        </script>


</div><div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>